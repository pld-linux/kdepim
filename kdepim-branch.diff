Index: akregator/src/mk4storage/akregator_mk4storage_plugin.desktop
===================================================================
--- akregator/src/mk4storage/akregator_mk4storage_plugin.desktop	(.../tags/KDE/3.5.10/kdepim)	(revision 987532)
+++ akregator/src/mk4storage/akregator_mk4storage_plugin.desktop	(.../branches/KDE/3.5/kdepim)	(revision 987532)
@@ -83,7 +83,7 @@
 Comment[nn]=Programtillegg til Akregator
 Comment[pl]=Wtyczka dla Akregatora
 Comment[pt]='Plugin' para o Akregator
-Comment[pt_BR]=Plugin para o Akregator
+Comment[pt_BR]=Plug-in para o Akregator
 Comment[ru]=Модуль Akregator
 Comment[se]=Lassemoduvla Akregatorii
 Comment[sk]=Modul pre Akregator
Index: akregator/src/akregator_plugin.desktop
===================================================================
--- akregator/src/akregator_plugin.desktop	(.../tags/KDE/3.5.10/kdepim)	(revision 987532)
+++ akregator/src/akregator_plugin.desktop	(.../branches/KDE/3.5/kdepim)	(revision 987532)
@@ -39,7 +39,7 @@
 Comment[nn]=Programtillegg til Akregator
 Comment[pl]=Wtyczka dla Akregatora
 Comment[pt]='Plugin' para o Akregator
-Comment[pt_BR]=Plugin para o Akregator
+Comment[pt_BR]=Plug-in para o Akregator
 Comment[ru]=Модуль Akregator
 Comment[se]=Lassemoduvla Akregatorii
 Comment[sk]=Modul pre Akregator
Index: wizards/groupwarewizard.desktop
===================================================================
--- wizards/groupwarewizard.desktop	(.../tags/KDE/3.5.10/kdepim)	(revision 987532)
+++ wizards/groupwarewizard.desktop	(.../branches/KDE/3.5/kdepim)	(revision 987532)
@@ -34,7 +34,7 @@
 Name[nn]=KDE-vegvisar for gruppevare
 Name[pl]=Asystent KDE Groupware
 Name[pt]=Assistente Groupware do KDE
-Name[pt_BR]=Assistente de Groupware do KDE
+Name[pt_BR]=Assistente Groupware do KDE
 Name[ru]=Мастер подключения к серверам совместной работы
 Name[sk]=Sprievodca KDE Groupware
 Name[sl]=Čarovnik za KDE Groupware
Index: kresources/scalix/kabc/scalix.desktop
===================================================================
--- kresources/scalix/kabc/scalix.desktop	(.../tags/KDE/3.5.10/kdepim)	(revision 987532)
+++ kresources/scalix/kabc/scalix.desktop	(.../branches/KDE/3.5/kdepim)	(revision 987532)
@@ -5,6 +5,7 @@
 Name[da]=Adressebog på Scalix-server via KMail
 Name[de]=Adressbuch auf einem Scalix-Server via KMail
 Name[el]=Βιβλίο διευθύνσεων σε εξυπηρετητή Scalix μέσω του KMail
+Name[es]=Libreta de direcciones en servidor Scalix por medio de KMail
 Name[et]=Aadressiraamat Scalix-serveris (KMaili vahendusel)
 Name[fr]=Carnet d'adresses sur serveur Scalix via KMail
 Name[is]=Vistfangaskrá á Scalix-þjóni gegnum KMail
Index: kresources/scalix/knotes/scalix.desktop
===================================================================
--- kresources/scalix/knotes/scalix.desktop	(.../tags/KDE/3.5.10/kdepim)	(revision 987532)
+++ kresources/scalix/knotes/scalix.desktop	(.../branches/KDE/3.5/kdepim)	(revision 987532)
@@ -5,6 +5,7 @@
 Name[da]=Noter på Scalix-server via KMail
 Name[de]=Notizen auf einem Scalix-Server via KMail
 Name[el]=Σημειώσεις σε εξυπηρετητή Scalix μέσω του KMail
+Name[es]=Notas en servidor Scalix por medio de KMail
 Name[et]=Kalender Scalix-serveris (KMaili vahendusel)
 Name[fr]=Notes sur serveur Scalix via KMail
 Name[is]=Minnismiðar á Scalix-þjóni gegnum KMail
Index: kresources/scalix/kcal/scalix.desktop
===================================================================
--- kresources/scalix/kcal/scalix.desktop	(.../tags/KDE/3.5.10/kdepim)	(revision 987532)
+++ kresources/scalix/kcal/scalix.desktop	(.../branches/KDE/3.5/kdepim)	(revision 987532)
@@ -5,6 +5,7 @@
 Name[da]=Kalender på Scalix-server via KMail
 Name[de]=Kalender auf einem Scalix-Server via KMail
 Name[el]=Ημερολόγιο σε εξυπηρετητή Scalix μέσω του KMail
+Name[es]=Calendario en servidor Scalix por medio de KMail
 Name[et]=Kalender Scalix-serveris (KMaili vahendusel)
 Name[fr]=Agenda sur serveur Scalix via KMail
 Name[is]=Dagatal á Scalix-þjóni gegnum KMail
@@ -14,6 +15,7 @@
 Name[nds]=Kalenner op Scalix-Server över KMail
 Name[nl]=Agenda op Scalix-server via KMail
 Name[pl]=Kalendarz na serwerze Scalix za pośrednictwem KMaila
+Name[pt_BR]=Calendário em Servidor Scalix via KMail
 Name[ru]=Календарь на сервере Scalix через KMail
 Name[sk]=Kalendár na Scalix serveri pomocou KMail
 Name[sr]=Календар на Scalix серверу преко KMail-а
Index: certmanager/lib/backends/qgpgme/qgpgmebackend.cpp
===================================================================
--- certmanager/lib/backends/qgpgme/qgpgmebackend.cpp	(.../tags/KDE/3.5.10/kdepim)	(revision 987532)
+++ certmanager/lib/backends/qgpgme/qgpgmebackend.cpp	(.../branches/KDE/3.5/kdepim)	(revision 987532)
@@ -54,7 +54,7 @@
     mOpenPGPProtocol( 0 ),
     mSMIMEProtocol( 0 )
 {
-
+  GpgME::initializeLibrary();
 }
 
 Kleo::QGpgMEBackend::~QGpgMEBackend() {
Index: libkmime/kmime_util.cpp
===================================================================
--- libkmime/kmime_util.cpp	(.../tags/KDE/3.5.10/kdepim)	(revision 987532)
+++ libkmime/kmime_util.cpp	(.../branches/KDE/3.5/kdepim)	(revision 987532)
@@ -195,8 +195,10 @@
           {
             str = KCodecs::base64Decode(str);
           }
-          for (i=0; str[i]; i++) {
-            *dest++ = str[i];
+          if (!str.isNull()) {
+            for (i=0; str[i]; i++) {
+              *dest++ = str[i];
+            }
           }
         }
 
Index: kmail/editorwatcher.cpp
===================================================================
--- kmail/editorwatcher.cpp	(.../tags/KDE/3.5.10/kdepim)	(revision 987532)
+++ kmail/editorwatcher.cpp	(.../branches/KDE/3.5/kdepim)	(revision 987532)
@@ -32,8 +32,12 @@
 #include <cassert>
 
 // inotify stuff taken from kdelibs/kio/kio/kdirwatch.cpp
-#ifdef HAVE_INOTIFY
+#ifdef HAVE_SYS_INOTIFY
 #include <sys/ioctl.h>
+#include <sys/inotify.h>
+#include <fcntl.h>
+#elif HAVE_INOTIFY
+#include <sys/ioctl.h>
 #include <unistd.h>
 #include <fcntl.h>
 #include <sys/syscall.h>
Index: kmail/kmail_config_composer.desktop
===================================================================
--- kmail/kmail_config_composer.desktop	(.../tags/KDE/3.5.10/kdepim)	(revision 987532)
+++ kmail/kmail_config_composer.desktop	(.../branches/KDE/3.5/kdepim)	(revision 987532)
@@ -71,6 +71,7 @@
 Comment[da]=Skabeloner & Generel opførsel
 Comment[de]=Vorlagen und allgemeines Verhalten
 Comment[el]=Πρότυπα & γενική Συμπεριφορά
+Comment[en_GB]=Templates & General Behaviour
 Comment[eo]=Ŝablonoj kaj Ĝenerala Konduto
 Comment[es]=Plantilla y comportamiento general
 Comment[et]=Mallid ja üldine käitumine
Index: kmail/kmcommands.cpp
===================================================================
--- kmail/kmcommands.cpp	(.../tags/KDE/3.5.10/kdepim)	(revision 987532)
+++ kmail/kmcommands.cpp	(.../branches/KDE/3.5/kdepim)	(revision 987532)
@@ -2414,7 +2414,8 @@
         .arg( mUrl.prettyURL() ), QString::null, i18n("Execute"), KStdGuiItem::cancel() ) != KMessageBox::Yes)
         return Canceled;
     }
-    (void) new KRun( mUrl );
+    KRun * runner = new KRun( mUrl );
+    runner->setRunExecutables( false );
   }
   else
     return Failed;
Index: kmail/kmfoldercachedimap.h
===================================================================
--- kmail/kmfoldercachedimap.h	(.../tags/KDE/3.5.10/kdepim)	(revision 987532)
+++ kmail/kmfoldercachedimap.h	(.../branches/KDE/3.5/kdepim)	(revision 987532)
@@ -213,8 +213,11 @@
   void setSilentUpload( bool silent ) { mSilentUpload = silent; }
   bool silentUpload() { return mSilentUpload; }
 
-  virtual int createIndexFromContents()
-    { return KMFolderMaildir::createIndexFromContents(); }
+  virtual int createIndexFromContents() {
+    const int result = KMFolderMaildir::createIndexFromContents();
+    reloadUidMap();
+    return result;
+  }
 
   int createIndexFromContentsRecursive();
 
Index: kmail/configure.in.in
===================================================================
--- kmail/configure.in.in	(.../tags/KDE/3.5.10/kdepim)	(revision 987532)
+++ kmail/configure.in.in	(.../branches/KDE/3.5/kdepim)	(revision 987532)
@@ -57,8 +57,30 @@
   AC_LANG_RESTORE
   ])
 
-  if test "$kde_cv_have_inotify" = "yes" ; then
+  AC_CACHE_VAL(kde_cv_have_sys_inotify,
+  [
+  kde_cv_have_sys_inotify=no
+  AC_LANG_SAVE
+  AC_LANG_C
+
+  AC_TRY_COMPILE(
+  [
+#include <sys/inotify.h>
+  ],
+  [
+#ifndef IN_ALL_EVENTS
+#error no inotify notification
+#endif
+  ],kde_cv_have_sys_inotify=yes,kde_cv_have_sys_inotify=no)
+
+  AC_LANG_RESTORE
+  ])
+
+  if test "$kde_cv_have_inotify" = "yes" -o "$kde_cv_have_sys_inotify" = "yes"; then
     AC_DEFINE_UNQUOTED(HAVE_INOTIFY, 1, [Define if your system has Linux Inode Notification])
+    if test "$kde_cv_have_sys_inotify" = "yes"; then
+      AC_DEFINE_UNQUOTED(HAVE_SYS_INOTIFY, 1, [Define if your system has glibc support for inotify])
+    fi
     AC_MSG_RESULT(yes)
   else
     AC_MSG_RESULT(no)
Index: kmail/accountmanager.cpp
===================================================================
--- kmail/accountmanager.cpp	(.../tags/KDE/3.5.10/kdepim)	(revision 987532)
+++ kmail/accountmanager.cpp	(.../branches/KDE/3.5/kdepim)	(revision 987532)
@@ -7,6 +7,7 @@
 #include "accountmanager.h"
 
 #include "kmaccount.h"
+#include "kmacctfolder.h"
 #include "kmacctmaildir.h"
 #include "kmacctlocal.h"
 #include "popaccount.h"
@@ -239,6 +240,11 @@
 {
   if ( account ) {
     mAcctList.append( account );
+    // init folder's account list
+    KMAcctFolder *folder = static_cast<KMAcctFolder*>( account->folder() );
+    if ( folder && !folder->hasAccounts() ) {
+      folder->addAccount( account );
+    }
     emit accountAdded( account );
     account->installTimer();
   }
Index: kmail/kmfoldertree.cpp
===================================================================
--- kmail/kmfoldertree.cpp	(.../tags/KDE/3.5.10/kdepim)	(revision 987532)
+++ kmail/kmfoldertree.cpp	(.../branches/KDE/3.5/kdepim)	(revision 987532)
@@ -432,6 +432,9 @@
   connect(kmkernel->acctMgr(), SIGNAL(accountRemoved(KMAccount*)),
           this, SLOT(slotAccountRemoved(KMAccount*)));
 
+  connect(kmkernel->acctMgr(), SIGNAL(accountAdded(KMAccount*)),
+          this, SLOT(slotUnhideLocalInbox()));
+
   connect(kmkernel->searchFolderMgr(), SIGNAL(folderRemoved(KMFolder*)),
           this, SLOT(slotFolderRemoved(KMFolder*)));
 
Index: kioslaves/sieve/sieve.cpp
===================================================================
--- kioslaves/sieve/sieve.cpp	(.../tags/KDE/3.5.10/kdepim)	(revision 987532)
+++ kioslaves/sieve/sieve.cpp	(.../branches/KDE/3.5/kdepim)	(revision 987532)
@@ -1290,7 +1290,7 @@
     const int minor = regExp.cap( 2 ).toInt();
     const int patch = regExp.cap( 3 ).toInt();
     const QString vendor = regExp.cap( 4 );
-    if ( major < 2 || (major == 2 && (minor < 3 || (major == 3 && patch < 11))) || (vendor == "-kolab-nocaps") ) {
+    if ( major < 2 || (major == 2 && (minor < 3 || (minor == 3 && patch < 11))) || (vendor == "-kolab-nocaps") ) {
       ksDebug() << k_funcinfo << "Enabling compat mode for Cyrus < 2.3.11 or Cyrus marked as \"kolab-nocaps\"" << endl;
       return true;
     }
Index: libkdenetwork/gpgmepp/context.cpp
===================================================================
--- libkdenetwork/gpgmepp/context.cpp	(.../tags/KDE/3.5.10/kdepim)	(revision 987532)
+++ libkdenetwork/gpgmepp/context.cpp	(.../branches/KDE/3.5/kdepim)	(revision 987532)
@@ -53,6 +53,10 @@
 
 namespace GpgME {
 
+  void initializeLibrary() {
+    gpgme_check_version( 0 );
+  }
+
   const char * Error::source() const {
     return gpgme_strsource( (gpgme_error_t)mErr );
   }
Index: libkdenetwork/gpgmepp/Makefile.am
===================================================================
--- libkdenetwork/gpgmepp/Makefile.am	(.../tags/KDE/3.5.10/kdepim)	(revision 987532)
+++ libkdenetwork/gpgmepp/Makefile.am	(.../branches/KDE/3.5/kdepim)	(revision 987532)
@@ -46,7 +46,7 @@
 #   (Interfaces added/removed/changed:  CURRENT++, REVISION=0)
 #   (Interfaces added:                  AGE++)
 #   (Interfaces removed/changed:        AGE=0)
-libgpgme___la_LDFLAGS = -no-undefined -version-info 3:0:3
+libgpgme___la_LDFLAGS = -no-undefined -version-info 4:0:4
 libgpgme___la_LIBADD = $(GPGME_LIBS)
 libgpgme___la_DEPENDENCIES = $(GPGME_LIBS_DEP)
 
Index: libkdenetwork/gpgmepp/context.h
===================================================================
--- libkdenetwork/gpgmepp/context.h	(.../tags/KDE/3.5.10/kdepim)	(revision 987532)
+++ libkdenetwork/gpgmepp/context.h	(.../branches/KDE/3.5/kdepim)	(revision 987532)
@@ -287,6 +287,8 @@
   //
   //
 
+  KDE_EXPORT void initializeLibrary();
+
   KDE_EXPORT GpgME::Error setDefaultLocale( int category, const char * value );
 
   KDE_EXPORT Context * wait( GpgME::Error & e, bool hang=true );
Index: kalarm/alarmevent.cpp
===================================================================
--- kalarm/alarmevent.cpp	(.../tags/KDE/3.5.10/kdepim)	(revision 987532)
+++ kalarm/alarmevent.cpp	(.../branches/KDE/3.5/kdepim)	(revision 987532)
@@ -1,7 +1,7 @@
 /*
  *  alarmevent.cpp  -  represents calendar alarms and events
  *  Program:  kalarm
- *  Copyright © 2001-2008 by David Jarvie <djarvie@kde.org>
+ *  Copyright © 2001-2009 by David Jarvie <djarvie@kde.org>
  *
  *  This program is free software; you can redistribute it and/or modify
  *  it under the terms of the GNU General Public License as published by
@@ -149,8 +149,10 @@
 
 inline void KAEvent::set_reminder(int minutes)
 {
-	if (!mReminderMinutes)
+	if (minutes  &&  !mReminderMinutes)
 		++mAlarmCount;
+	else if (!minutes  &&  mReminderMinutes)
+		--mAlarmCount;
 	mReminderMinutes        = minutes;
 	mArchiveReminderMinutes = 0;
 }
@@ -856,9 +858,12 @@
 
 void KAEvent::setReminder(int minutes, bool onceOnly)
 {
-	set_reminder(minutes);
-	mReminderOnceOnly = onceOnly;
-	mUpdated          = true;
+	if (minutes != mReminderMinutes)
+	{
+		set_reminder(minutes);
+		mReminderOnceOnly = onceOnly;
+		mUpdated          = true;
+	}
 }
 
 /******************************************************************************
Index: kalarm/messagewin.cpp
===================================================================
--- kalarm/messagewin.cpp	(.../tags/KDE/3.5.10/kdepim)	(revision 987532)
+++ kalarm/messagewin.cpp	(.../branches/KDE/3.5/kdepim)	(revision 987532)
@@ -1,7 +1,7 @@
 /*
  *  messagewin.cpp  -  displays an alarm message
  *  Program:  kalarm
- *  Copyright © 2001-2007 by David Jarvie <software@astrojar.org.uk>
+ *  Copyright © 2001-2009 by David Jarvie <djarvie@kde.org>
  *
  *  This program is free software; you can redistribute it and/or modify
  *  it under the terms of the GNU General Public License as published by
@@ -87,6 +87,8 @@
 static const int proximityButtonDelay = 1000;    // (milliseconds)
 static const int proximityMultiple = 10;         // multiple of button height distance from cursor for proximity
 
+static bool wantModal();
+
 // A text label widget which can be scrolled and copied with the mouse
 class MessageText : public QTextEdit
 {
@@ -143,7 +145,7 @@
 */
 MessageWin::MessageWin(const KAEvent& event, const KAAlarm& alarm, bool reschedule_event, bool allowDefer)
 	: MainWindowBase(0, "MessageWin", WFLAGS | Qt::WGroupLeader | Qt::WStyle_ContextHelp
-	                                         | (Preferences::modalMessages() ? 0 : Qt::WX11BypassWM)),
+	                                         | (wantModal() ? 0 : Qt::WX11BypassWM)),
 	  mMessage(event.cleanText()),
 	  mFont(event.font()),
 	  mBgColour(event.bgColour()),
@@ -598,8 +600,10 @@
 	topLayout->activate();
 	setMinimumSize(QSize(grid->sizeHint().width() + 2*KDialog::marginHint(), sizeHint().height()));
 
+	bool modal = !(getWFlags() & Qt::WX11BypassWM);
+
+	unsigned long wstate = (modal ? NET::Modal : 0) | NET::Sticky | NET::KeepAbove;
 	WId winid = winId();
-	unsigned long wstate = (Preferences::modalMessages() ? NET::Modal : 0) | NET::Sticky | NET::StaysOnTop;
 	KWin::setState(winid, wstate);
 	KWin::setOnAllDesktops(winid, true);
 }
@@ -871,7 +875,6 @@
 		initAudio(true);
 		if (!mPlayObject->object().isNull())
 			checkAudioPlay();
-#if KDE_VERSION >= 308
 		if (!mUsingKMix  &&  mVolume >= 0)
 		{
 			// Output error message now that everything else has been done.
@@ -884,7 +887,6 @@
 				clearErrorMessage(ErrMsg_Volume);
 			}
 		}
-#endif
 	}
 #endif
 }
@@ -1395,7 +1397,7 @@
 void MessageWin::closeEvent(QCloseEvent* ce)
 {
 	// Don't prompt or delete the alarm from the display calendar if the session is closing
-	if (!theApp()->sessionClosingDown())
+	if (!mErrorWindow  &&  !theApp()->sessionClosingDown())
 	{
 		if (mConfirmAck  &&  !mNoCloseConfirm)
 		{
@@ -1639,6 +1641,26 @@
 }
 
 
+/******************************************************************************
+* Check whether the message window should be modal, i.e. with title bar etc.
+* Normally this follows the Preferences setting, but if there is a full screen
+* window displayed, on X11 the message window has to bypass the window manager
+* in order to display on top of it (which has the side effect that it will have
+* no window decoration).
+*/
+bool wantModal()
+{
+	bool modal = Preferences::modalMessages();
+	if (modal)
+	{
+		KWinModule wm(0, KWinModule::INFO_DESKTOP);
+		KWin::WindowInfo wi = KWin::windowInfo(wm.activeWindow(), NET::WMState);
+		modal = !(wi.valid()  &&  wi.hasState(NET::FullScreen));
+	}
+	return modal;
+}
+
+
 /*=============================================================================
 = Class MWMimeSourceFactory
 * Gets the mime type of a text file from not only its extension (as per
Index: kalarm/templatepickdlg.cpp
===================================================================
--- kalarm/templatepickdlg.cpp	(.../tags/KDE/3.5.10/kdepim)	(revision 987532)
+++ kalarm/templatepickdlg.cpp	(.../branches/KDE/3.5/kdepim)	(revision 987532)
@@ -1,7 +1,7 @@
 /*
  *  templatepickdlg.cpp  -  dialogue to choose an alarm template
  *  Program:  kalarm
- *  Copyright (C) 2004 by David Jarvie <software@astrojar.org.uk>
+ *  Copyright © 2004,2008 by David Jarvie <djarvie@kde.org>
  *
  *  This program is free software; you can redistribute it and/or modify
  *  it under the terms of the GNU General Public License as published by
@@ -47,7 +47,8 @@
 	mTemplateList->setSelectionMode(QListView::Single);
 	mTemplateList->refresh();      // populate the template list
 	connect(mTemplateList, SIGNAL(selectionChanged()), SLOT(slotSelectionChanged()));
-	connect(mTemplateList, SIGNAL(executed(QListViewItem*)), SLOT(slotOk()));
+	// Require a real double click (even if KDE is in single-click mode) to accept the selection
+	connect(mTemplateList, SIGNAL(doubleClicked(QListViewItem*, const QPoint&, int)), SLOT(slotOk()));
 	topLayout->addWidget(mTemplateList);
 
 	slotSelectionChanged();        // enable or disable the OK button
Index: kalarm/editdlg.cpp
===================================================================
--- kalarm/editdlg.cpp	(.../tags/KDE/3.5.10/kdepim)	(revision 987532)
+++ kalarm/editdlg.cpp	(.../branches/KDE/3.5/kdepim)	(revision 987532)
@@ -1522,7 +1522,8 @@
 	bool limit = true;
 	int repeatInterval;
 	int repeatCount = mRecurrenceEdit->subRepeatCount(&repeatInterval);
-	DateTime start = mTimeWidget->getDateTime(0, !repeatCount, !mExpiredRecurrence);
+	DateTime start = mSavedEvent->recurs() ? (mExpiredRecurrence ? DateTime() : mSavedEvent->mainDateTime())
+	               : mTimeWidget->getDateTime(0, !repeatCount, !mExpiredRecurrence);
 	if (!start.isValid())
 	{
 		if (!mExpiredRecurrence)
Index: kalarm/functions.h
===================================================================
--- kalarm/functions.h	(.../tags/KDE/3.5.10/kdepim)	(revision 987532)
+++ kalarm/functions.h	(.../branches/KDE/3.5/kdepim)	(revision 987532)
@@ -1,7 +1,7 @@
 /*
  *  functions.h  -  miscellaneous functions
  *  Program:  kalarm
- *  Copyright © 2004-2006 by David Jarvie <software@astrojar.org.uk>
+ *  Copyright © 2004-2006,2009 by David Jarvie <djarvie@kde.org>
  *
  *  This program is free software; you can redistribute it and/or modify
  *  it under the terms of the GNU General Public License as published by
@@ -108,6 +108,7 @@
 void                displayUpdateError(QWidget* parent, UpdateStatus, UpdateError, int nAlarms);
 void                displayKOrgUpdateError(QWidget* parent, KOrgUpdateError, int nAlarms);
 
+void                cancelScreenSaver();
 QString             stripAccel(const QString&);
 
 int                 localeFirstDayOfWeek();
Index: kalarm/kalarm.h
===================================================================
--- kalarm/kalarm.h	(.../tags/KDE/3.5.10/kdepim)	(revision 987532)
+++ kalarm/kalarm.h	(.../branches/KDE/3.5/kdepim)	(revision 987532)
@@ -26,7 +26,7 @@
 #include <config.h>
 #endif
 
-#define KALARM_VERSION "1.5.4"
+#define KALARM_VERSION "1.5.5"
 #define KALARM_NAME "KAlarm"
 
 #include <kdeversion.h>
Index: kalarm/Changelog
===================================================================
--- kalarm/Changelog	(.../tags/KDE/3.5.10/kdepim)	(revision 987532)
+++ kalarm/Changelog	(.../branches/KDE/3.5/kdepim)	(revision 987532)
@@ -1,6 +1,23 @@
 KAlarm Change Log
 
-=== Version 1.5.4 --- 18 August 2008 ===
+=== Version 1.5.5 --- 21 January 2009 ===
+- Require a real double click to accept the selected template in pick list.
+- Make mouse wheel work, and fix highlighting, for left-hand time spinbox
+  buttons in Plastik style.
+- Ensure alarm windows show on top of full-screen windows.
+- Fix failure to update alarms in KOrganizer when Kontact is running but
+  Kontact's calendar component is not loaded.
+- Fix inability to change or cancel alarm deferral times.
+- Fix invalid alarm remaining in calendar when pre-alarm action failure message
+  is acknowledged before the alarm is deferred.
+- Prevent corrupt alarms if deferral reinstates from archived alarm instead of
+  from the displaying calendar.
+- Ignore events in calendar without usable alarms, which prevents them getting
+  stuck in the alarm list).
+- Prevent defer dialogue date being set outside the allowed range.
+- Cancel screensaver when an alarm is displayed.
+
+=== Version 1.5.4 (KDE 3.5.10) --- 18 August 2008 ===
 - Show background colour selector for file display alarms.
 - Display default font correctly in alarm edit dialogue sample text.
 - Expand font selection control when dialogue is expanded.
Index: kalarm/kalarmapp.cpp
===================================================================
--- kalarm/kalarmapp.cpp	(.../tags/KDE/3.5.10/kdepim)	(revision 987532)
+++ kalarm/kalarmapp.cpp	(.../branches/KDE/3.5/kdepim)	(revision 987532)
@@ -1,7 +1,7 @@
 /*
  *  kalarmapp.cpp  -  the KAlarm application object
  *  Program:  kalarm
- *  Copyright © 2001-2008 by David Jarvie <djarvie@kde.org>
+ *  Copyright © 2001-2009 by David Jarvie <djarvie@kde.org>
  *
  *  This program is free software; you can redistribute it and/or modify
  *  it under the terms of the GNU General Public License as published by
@@ -1631,11 +1631,13 @@
 				if (win)
 					win->setRecreating();    // prevent post-alarm actions
 				delete win;
+				KAlarm::cancelScreenSaver();
 				(new MessageWin(event, alarm, reschedule, allowDefer))->show();
 			}
 			else
 			{
 				// Raise the existing message window and replay any sound
+				KAlarm::cancelScreenSaver();
 				win->repeat(alarm);    // N.B. this reschedules the alarm
 			}
 			break;
Index: kalarm/lib/spinbox.cpp
===================================================================
--- kalarm/lib/spinbox.cpp	(.../tags/KDE/3.5.10/kdepim)	(revision 987532)
+++ kalarm/lib/spinbox.cpp	(.../branches/KDE/3.5/kdepim)	(revision 987532)
@@ -1,7 +1,7 @@
 /*
  *  spinbox.cpp  -  spin box with read-only option and shift-click step value
  *  Program:  kalarm
- *  Copyright (C) 2002, 2004 by David Jarvie <software@astrojar.org.uk>
+ *  Copyright © 2002,2004,2008 by David Jarvie <djarvie@kde.org>
  *
  *  This program is free software; you can redistribute it and/or modify
  *  it under the terms of the GNU General Public License as published by
@@ -76,7 +76,7 @@
 		mReadOnly = ro;
 		editor()->setReadOnly(ro);
 		if (ro)
-			setShiftStepping(false);
+			setShiftStepping(false, mCurrentButton);
 	}
 }
 
@@ -203,38 +203,56 @@
 {
 	if (obj == editor())
 	{
-		if (e->type() == QEvent::KeyPress)
+		int step = 0;
+		bool shift = false;
+		switch (e->type())
 		{
-			// Up and down arrow keys step the value
-			QKeyEvent* ke = (QKeyEvent*)e;
-			int key = ke->key();
-			if (key == Qt::Key_Up  ||  key == Qt::Key_Down)
+			case QEvent::KeyPress:
 			{
-				if (mReadOnly)
-					return true;    // discard up/down arrow keys
-				int step;
-				if ((ke->state() & (Qt::ShiftButton | Qt::AltButton)) == Qt::ShiftButton)
-				{
-					// Shift stepping
-					int val = value();
-					if (key == Qt::Key_Up)
-						step = mLineShiftStep - val % mLineShiftStep;
-					else
-						step = - ((val + mLineShiftStep - 1) % mLineShiftStep + 1);
-				}
-				else
-					step = (key == Qt::Key_Up) ? mLineStep : -mLineStep;
-				addValue(step, false);
-				return true;
+				// Up and down arrow keys step the value
+				QKeyEvent* ke = (QKeyEvent*)e;
+				int key = ke->key();
+				if (key == Qt::Key_Up)
+					step = 1;
+				else if (key == Qt::Key_Down)
+					step = -1;
+				shift = ((ke->state() & (Qt::ShiftButton | Qt::AltButton)) == Qt::ShiftButton);
+				break;
 			}
+			case QEvent::Wheel:
+			{
+				QWheelEvent* we = (QWheelEvent*)e;
+				step = (we->delta() > 0) ? 1 : -1;
+				shift = ((we->state() & (Qt::ShiftButton | Qt::AltButton)) == Qt::ShiftButton);
+				break;
+			}
+#if KDE_IS_VERSION(3,1,90)
+			case QEvent::Leave:
+				if (mEdited)
+					interpretText();
+				break;
+#endif
+			default:
+				break;
 		}
-#if KDE_IS_VERSION(3,1,90)
-		else if (e->type() == QEvent::Leave)
+		if (step)
 		{
-			if (mEdited)
-				interpretText();
+			if (mReadOnly)
+				return true;    // discard up/down arrow keys or wheel
+			if (shift)
+			{
+				// Shift stepping
+				int val = value();
+				if (step > 0)
+					step = mLineShiftStep - val % mLineShiftStep;
+				else
+					step = - ((val + mLineShiftStep - 1) % mLineShiftStep + 1);
+			}
+			else
+				step = (step > 0) ? mLineStep : -mLineStep;
+			addValue(step, false);
+			return true;
 		}
-#endif
 	}
 	else
 	{
@@ -254,7 +272,7 @@
 					if (mCurrentButton == NO_BUTTON)
 						return true;
 					bool shift = (me->state() & (Qt::ShiftButton | Qt::AltButton)) == Qt::ShiftButton;
-					if (setShiftStepping(shift))
+					if (setShiftStepping(shift, mCurrentButton))
 						return true;     // hide the event from the spin widget
 					return false;    // forward event to the destination widget
 				}
@@ -265,7 +283,7 @@
 				QMouseEvent* me = (QMouseEvent*)e;
 				if (me->button() == Qt::LeftButton  &&  mShiftMouse)
 				{
-					setShiftStepping(false);    // cancel shift stepping
+					setShiftStepping(false, mCurrentButton);    // cancel shift stepping
 					return false;    // forward event to the destination widget
 				}
 				break;
@@ -285,13 +303,21 @@
 						// Set normal or shift stepping as appropriate.
 						mCurrentButton = newButton;
 						bool shift = (me->state() & (Qt::ShiftButton | Qt::AltButton)) == Qt::ShiftButton;
-						if (setShiftStepping(shift))
+						if (setShiftStepping(shift, mCurrentButton))
 							return true;     // hide the event from the spin widget
 					}
 					return false;    // forward event to the destination widget
 				}
 				break;
 			}
+			case QEvent::Wheel:
+			{
+				QWheelEvent* we = (QWheelEvent*)e;
+				bool shift = (we->state() & (Qt::ShiftButton | Qt::AltButton)) == Qt::ShiftButton;
+				if (setShiftStepping(shift, (we->delta() > 0 ? UP : DOWN)))
+					return true;     // hide the event from the spin widget
+				return false;    // forward event to the destination widget
+			}
 			case QEvent::KeyPress:
 			case QEvent::KeyRelease:
 			case QEvent::AccelOverride:      // this is needed to receive Shift presses!
@@ -307,11 +333,11 @@
 						return true;   // discard the event
 					state ^= (key == Qt::Key_Shift) ? Qt::ShiftButton : Qt::AltButton;    // new state
 					bool shift = (state & (Qt::ShiftButton | Qt::AltButton)) == Qt::ShiftButton;
-					if (!shift && mShiftMouse  ||  shift && !mShiftMouse)
+					if ((!shift && mShiftMouse)  ||  (shift && !mShiftMouse))
 					{
 						// The effective shift state has changed.
 						// Set normal or shift stepping as appropriate.
-						if (setShiftStepping(shift))
+						if (setShiftStepping(shift, mCurrentButton))
 							return true;     // hide the event from the spin widget
 					}
 				}
@@ -325,9 +351,9 @@
 /******************************************************************************
 * Set spin widget stepping to the normal or shift increment.
 */
-bool SpinBox::setShiftStepping(bool shift)
+bool SpinBox::setShiftStepping(bool shift, int currentButton)
 {
-	if (mCurrentButton == NO_BUTTON)
+	if (currentButton == NO_BUTTON)
 		shift = false;
 	if (shift  &&  !mShiftMouse)
 	{
@@ -337,7 +363,7 @@
 		 * step by the shift amount.
 		 */
 		int val = value();
-		int step = (mCurrentButton == UP) ? mLineShiftStep : (mCurrentButton == DOWN) ? -mLineShiftStep : 0;
+		int step = (currentButton == UP) ? mLineShiftStep : (currentButton == DOWN) ? -mLineShiftStep : 0;
 		int adjust = shiftStepAdjustment(val, step);
 		mShiftMouse = true;
 		if (adjust)
Index: kalarm/lib/spinbox2private.h
===================================================================
--- kalarm/lib/spinbox2private.h	(.../tags/KDE/3.5.10/kdepim)	(revision 987532)
+++ kalarm/lib/spinbox2private.h	(.../branches/KDE/3.5/kdepim)	(revision 987532)
@@ -1,7 +1,7 @@
 /*
  *  spinbox2private.h  -  private classes for SpinBox2 (for Qt 3)
  *  Program:  kalarm
- *  Copyright © 2005,2006 by David Jarvie <software@astrojar.org.uk>
+ *  Copyright © 2005,2006,2008 by David Jarvie <djarvie@kde.org>
  *
  *  This program is free software; you can redistribute it and/or modify
  *  it under the terms of the GNU General Public License as published by
@@ -61,7 +61,7 @@
 {
 		Q_OBJECT
 	public:
-		explicit SpinMirror(SpinBox*, QWidget* parent = 0, const char* name = 0);
+		explicit SpinMirror(SpinBox*, QFrame* spinFrame, QWidget* parent = 0, const char* name = 0);
 		void         setReadOnly(bool ro)        { mReadOnly = ro; }
 		bool         isReadOnly() const          { return mReadOnly; }
 		void         setNormalButtons(const QPixmap&);
@@ -69,17 +69,21 @@
 
 	public slots:
 		virtual void resize(int w, int h);
+		void         redraw();
 
 	protected:
 		virtual void contentsMousePressEvent(QMouseEvent* e)        { contentsMouseEvent(e); }
 		virtual void contentsMouseReleaseEvent(QMouseEvent* e)      { contentsMouseEvent(e); }
 		virtual void contentsMouseMoveEvent(QMouseEvent* e)         { contentsMouseEvent(e); }
 		virtual void contentsMouseDoubleClickEvent(QMouseEvent* e)  { contentsMouseEvent(e); }
+		virtual void contentsWheelEvent(QWheelEvent*);
+		virtual bool event(QEvent*);
 
 	private:
 		void         contentsMouseEvent(QMouseEvent*);
 
 		SpinBox*     mSpinbox;        // spinbox whose spin buttons are being mirrored
+		QFrame*      mSpinFrame;      // widget containing mSpinbox's spin buttons
 		QWidget*     mSpinWidget;     // spin buttons in mSpinbox
 		QPixmap      mNormalButtons;  // image of spin buttons in unpressed state
 		bool         mReadOnly;       // value cannot be changed
Index: kalarm/lib/spinbox2.cpp
===================================================================
--- kalarm/lib/spinbox2.cpp	(.../tags/KDE/3.5.10/kdepim)	(revision 987532)
+++ kalarm/lib/spinbox2.cpp	(.../branches/KDE/3.5/kdepim)	(revision 987532)
@@ -1,7 +1,7 @@
 /*
  *  spinbox2.cpp  -  spin box with extra pair of spin buttons (for Qt 3)
  *  Program:  kalarm
- *  Copyright (c) 2001 - 2005 by David Jarvie <software@astrojar.org.uk>
+ *  Copyright © 2001-2005,2008 by David Jarvie <djarvie@kde.org>
  *
  *  This program is free software; you can redistribute it and/or modify
  *  it under the terms of the GNU General Public License as published by
@@ -26,6 +26,8 @@
 #include <qobjectlist.h>
 #include <qapplication.h>
 #include <qpixmap.h>
+#include <qcursor.h>
+#include <qtimer.h>
 #include <qwmatrix.h>
 
 #include "spinbox2.moc"
@@ -84,7 +86,7 @@
 	mUpdown2->setSelectOnStep(false);    // always false
 	setFocusProxy(mSpinbox);
 	mUpdown2->setFocusPolicy(QWidget::NoFocus);
-	mSpinMirror = new SpinMirror(mUpdown2, this);
+	mSpinMirror = new SpinMirror(mUpdown2, mUpdown2Frame, this);
 	if (!mirrorStyle(style()))
 		mSpinMirror->hide();    // hide mirrored spin buttons when they are inappropriate
 	connect(mSpinbox, SIGNAL(valueChanged(int)), SLOT(valueChange()));
@@ -322,8 +324,8 @@
 		}
 		int adjust = mSpinbox->shiftStepAdjustment(oldValue, step);
 		if (adjust == -step
-		&&  (step > 0  &&  oldValue + step >= mSpinbox->maxValue()
-		  || step < 0  &&  oldValue + step <= mSpinbox->minValue()))
+		&&  ((step > 0  &&  oldValue + step >= mSpinbox->maxValue())
+		  || (step < 0  &&  oldValue + step <= mSpinbox->minValue())))
 			adjust = 0;    // allow stepping to the minimum or maximum value
 		mSpinbox->addValue(adjust + step);
 	}
@@ -389,9 +391,10 @@
 = Class SpinMirror
 =============================================================================*/
 
-SpinMirror::SpinMirror(SpinBox* spinbox, QWidget* parent, const char* name)
+SpinMirror::SpinMirror(SpinBox* spinbox, QFrame* spinFrame, QWidget* parent, const char* name)
 	: QCanvasView(new QCanvas, parent, name),
 	  mSpinbox(spinbox),
+	  mSpinFrame(spinFrame),
 	  mReadOnly(false)
 {
 	setVScrollBarMode(QScrollView::AlwaysOff);
@@ -411,6 +414,11 @@
 	redraw(mNormalButtons);
 }
 
+void SpinMirror::redraw()
+{
+	redraw(QPixmap::grabWidget(mSpinFrame, 0, 0));
+}
+
 void SpinMirror::redraw(const QPixmap& px)
 {
 	QCanvas* c = canvas();
@@ -432,16 +440,57 @@
 */
 void SpinMirror::contentsMouseEvent(QMouseEvent* e)
 {
-	if (!mReadOnly)
+	if (mReadOnly)
+		return;
+	QPoint pt = contentsToViewport(e->pos());
+	pt.setX(pt.x() + mSpinbox->upRect().left());
+	QApplication::postEvent(mSpinWidget, new QMouseEvent(e->type(), pt, e->button(), e->state()));
+
+	// If the mouse button has been pressed or released, refresh the spin buttons
+	switch (e->type())
 	{
-		QPoint pt = contentsToViewport(e->pos());
-		pt.setX(pt.x() + mSpinbox->upRect().left());
-		QApplication::postEvent(mSpinWidget, new QMouseEvent(e->type(), pt, e->button(), e->state()));
+		case QEvent::MouseButtonPress:
+		case QEvent::MouseButtonRelease:
+			QTimer::singleShot(0, this, SLOT(redraw()));
+			break;
+		default:
+			break;
+	}
+}
 
-		// If the mouse button has been released, display unpressed spin buttons
-		if (e->type() == QEvent::MouseButtonRelease)
-			redraw(mNormalButtons);
+/******************************************************************************
+* Pass on all mouse events to the spinbox which we're covering up.
+*/
+void SpinMirror::contentsWheelEvent(QWheelEvent* e)
+{
+	if (mReadOnly)
+		return;
+	QPoint pt = contentsToViewport(e->pos());
+	pt.setX(pt.x() + mSpinbox->upRect().left());
+	QApplication::postEvent(mSpinWidget, new QWheelEvent(pt, e->delta(), e->state(), e->orientation()));
+}
+
+/******************************************************************************
+* Pass on to the main spinbox events which are needed to activate mouseover and
+* other graphic effects when the mouse cursor enters and leaves the widget.
+*/
+bool SpinMirror::event(QEvent* e)
+{
+	switch (e->type())
+	{
+		case QEvent::Leave:
+		case QEvent::Enter:
+			QApplication::postEvent(mSpinWidget, new QEvent(e->type()));
+			QTimer::singleShot(0, this, SLOT(redraw()));
+			break;
+		case QEvent::FocusIn:
+			mSpinbox->setFocus();
+			QTimer::singleShot(0, this, SLOT(redraw()));
+			break;
+		default:
+			break;
 	}
+	return QCanvasView::event(e);
 }
 
 
Index: kalarm/lib/dateedit.cpp
===================================================================
--- kalarm/lib/dateedit.cpp	(.../tags/KDE/3.5.10/kdepim)	(revision 987532)
+++ kalarm/lib/dateedit.cpp	(.../branches/KDE/3.5/kdepim)	(revision 987532)
@@ -61,11 +61,13 @@
 		{
 			pastLimitMessage(mMinDate, mMinDateErrString,
 					 i18n("Date cannot be earlier than %1"));
+			setDate(mMinDate);
 		}
 		else if (mMaxDate.isValid()  &&  newDate > mMaxDate)
 		{
 			pastLimitMessage(mMaxDate, mMaxDateErrString,
 					 i18n("Date cannot be later than %1"));
+			setDate(mMaxDate);
 		}
 	}
 }
Index: kalarm/lib/spinbox.h
===================================================================
--- kalarm/lib/spinbox.h	(.../tags/KDE/3.5.10/kdepim)	(revision 987532)
+++ kalarm/lib/spinbox.h	(.../branches/KDE/3.5/kdepim)	(revision 987532)
@@ -1,7 +1,7 @@
 /*
  *  spinbox.h  -  spin box with shift-click step value and read-only option
  *  Program:  kalarm
- *  Copyright © 2002-2006 by David Jarvie <software@astrojar.org.uk>
+ *  Copyright © 2002-2006,2008 by David Jarvie <djarvie@kde.org>
  *
  *  This program is free software; you can redistribute it and/or modify
  *  it under the terms of the GNU General Public License as published by
@@ -135,7 +135,7 @@
 		void         init();
 		void         addValue(int change, bool current);
 		int          whichButton(const QPoint&);
-		bool         setShiftStepping(bool);
+		bool         setShiftStepping(bool, int currentButton);
 
 		enum { NO_BUTTON, UP, DOWN };
 
Index: kalarm/recurrenceedit.cpp
===================================================================
--- kalarm/recurrenceedit.cpp	(.../tags/KDE/3.5.10/kdepim)	(revision 987532)
+++ kalarm/recurrenceedit.cpp	(.../branches/KDE/3.5/kdepim)	(revision 987532)
@@ -1224,11 +1224,7 @@
 DailyRule::DailyRule(bool readOnly, QWidget* parent, const char* name)
 	: DayWeekRule(i18n("day(s)"),
 	              i18n("Enter the number of days between repetitions of the alarm"),
-#if KDE_IS_VERSION(3,9,0)
 	              i18n("Select the days of the week on which the alarm is allowed to occur"),
-#else
-	              i18n("Select the days of the week on which to repeat the alarm"),
-#endif
 	              readOnly, parent, name)
 { }
 
Index: kalarm/functions.cpp
===================================================================
--- kalarm/functions.cpp	(.../tags/KDE/3.5.10/kdepim)	(revision 987532)
+++ kalarm/functions.cpp	(.../branches/KDE/3.5/kdepim)	(revision 987532)
@@ -1,7 +1,7 @@
 /*
  *  functions.cpp  -  miscellaneous functions
  *  Program:  kalarm
- *  Copyright © 2001-2008 by David Jarvie <djarvie@kde.org>
+ *  Copyright © 2001-2009 by David Jarvie <djarvie@kde.org>
  *
  *  This program is free software; you can redistribute it and/or modify
  *  it under the terms of the GNU General Public License as published by
@@ -47,6 +47,8 @@
 #include <kmessagebox.h>
 #include <kfiledialog.h>
 #include <dcopclient.h>
+#include <dcopref.h>
+#include <kdcopservicestarter.h>
 #include <kdebug.h>
 
 #include <libkcal/event.h>
@@ -61,14 +63,17 @@
 bool        resetDaemonQueued = false;
 QCString    korganizerName = "korganizer";
 QString     korgStartError;
-const char* KORG_DCOP_OBJECT  = "KOrganizerIface";
+#define     KORG_DCOP_OBJECT    "KOrganizerIface"
 const char* KORG_DCOP_WINDOW  = "KOrganizer MainWindow";
 const char* KMAIL_DCOP_WINDOW = "kmail-mainwindow#1";
 
 bool sendToKOrganizer(const KAEvent&);
 bool deleteFromKOrganizer(const QString& eventID);
-inline bool runKOrganizer()   { return KAlarm::runProgram("korganizer", KORG_DCOP_WINDOW, korganizerName, korgStartError); }
+bool runKOrganizer();
 }
+#ifdef HAVE_XTEST
+void x11_cancelScreenSaver();
+#endif
 
 
 namespace KAlarm
@@ -926,6 +931,17 @@
 	return out;
 }
 
+/******************************************************************************
+* Cancel the screen saver, in case it is active.
+* Only implemented if the X11 XTest extension is installed.
+*/
+void cancelScreenSaver()
+{
+#ifdef HAVE_XTEST
+	x11_cancelScreenSaver();
+#endif // HAVE_XTEST
+}
+
 } // namespace KAlarm
 
 
@@ -1023,4 +1039,61 @@
 	return false;
 }
 
+/******************************************************************************
+* Start KOrganizer if not already running, and create its DCOP interface.
+*/
+bool runKOrganizer()
+{
+	QString error;
+	QCString dcopService;
+	int result = KDCOPServiceStarter::self()->findServiceFor("DCOP/Organizer", QString::null, QString::null, &error, &dcopService);
+	if (result)
+	{
+		kdDebug(5950) << "Unable to start DCOP/Organizer: " << dcopService << " " << error << endl;
+		return false;
+	}
+	// If Kontact is running, there is be a load() method which needs to be called
+	// to load KOrganizer into Kontact. But if KOrganizer is running independently,
+	// the load() method doesn't exist.
+	QCString dummy;
+	if (!kapp->dcopClient()->findObject(dcopService, KORG_DCOP_OBJECT, "", QByteArray(), dummy, dummy))
+	{
+		DCOPRef ref(dcopService, dcopService); // talk to the KUniqueApplication or its Kontact wrapper
+		DCOPReply reply = ref.call("load()");
+		if (!reply.isValid() || !(bool)reply)
+		{
+			kdWarning(5950) << "Error loading " << dcopService << endl;
+			return false;
+		}
+		if (!kapp->dcopClient()->findObject(dcopService, KORG_DCOP_OBJECT, "", QByteArray(), dummy, dummy))
+		{
+			kdWarning(5950) << "Unable to access KOrganizer's "KORG_DCOP_OBJECT" DCOP object" << endl;
+			return false;
+		}
+	}
+	return true;
+}
+
 } // namespace
+
+#ifdef HAVE_XTEST
+#include <X11/keysym.h>
+#include <X11/extensions/XTest.h>
+#include <qwindowdefs.h>
+
+/******************************************************************************
+* Cancel the screen saver, in case it is active.
+* Only implemented if the X11 XTest extension is installed.
+*/
+void x11_cancelScreenSaver()
+{
+	kdDebug(5950) << "KAlarm::cancelScreenSaver()" << endl;
+	Display* display = qt_xdisplay();
+	static int XTestKeyCode = 0;
+	if (!XTestKeyCode)
+		XTestKeyCode = XKeysymToKeycode(display, XK_Shift_L);
+	XTestFakeKeyEvent(display, XTestKeyCode, true, CurrentTime);
+	XTestFakeKeyEvent(display, XTestKeyCode, false, CurrentTime);
+	XSync(display, false);
+}
+#endif // HAVE_XTEST
Index: kalarm/alarmcalendar.cpp
===================================================================
--- kalarm/alarmcalendar.cpp	(.../tags/KDE/3.5.10/kdepim)	(revision 987532)
+++ kalarm/alarmcalendar.cpp	(.../branches/KDE/3.5/kdepim)	(revision 987532)
@@ -1,7 +1,7 @@
 /*
  *  alarmcalendar.cpp  -  KAlarm calendar file access
  *  Program:  kalarm
- *  Copyright © 2001-2006 by David Jarvie <software@astrojar.org.uk>
+ *  Copyright © 2001-2006,2009 by David Jarvie <djarvie@kde.org>
  *
  *  This program is free software; you can redistribute it and/or modify
  *  it under the terms of the GNU General Public License as published by
@@ -506,8 +506,8 @@
 		for (Event::List::ConstIterator it = events.begin();  it != events.end();  ++it)
 		{
 			const Event* event = *it;
-			if (event->alarms().isEmpty())
-				continue;    // ignore events without alarms
+			if (event->alarms().isEmpty()  ||  !KAEvent(*event).valid())
+				continue;    // ignore events without alarms, or usable alarms
 			KAEvent::Status type = KAEvent::uidStatus(event->uid());
 			switch (type)
 			{
@@ -821,7 +821,7 @@
 }
 
 /******************************************************************************
-* Return all events in the calendar which contain alarms.
+* Return all events in the calendar which contain usable alarms.
 */
 KCal::Event::List AlarmCalendar::events()
 {
@@ -831,7 +831,8 @@
 	KCal::Event::List::Iterator it = list.begin();
 	while (it != list.end())
 	{
-		if ((*it)->alarms().isEmpty())
+		KCal::Event* event = *it;
+		if (event->alarms().isEmpty()  ||  !KAEvent(*event).valid())
 			it = list.remove(it);
 		else
 			++it;
@@ -846,10 +847,8 @@
 {
 	kdDebug(5950) << "AlarmCalendar::eventsWithAlarms(" << from.toString() << " - " << to.toString() << ")\n";
 	Event::List evnts;
-	if (!mCalendar)
-		return evnts;
 	QDateTime dt;
-	Event::List allEvents = mCalendar->rawEvents();
+	Event::List allEvents = events();   // ignore events without usable alarms
 	for (Event::List::ConstIterator it = allEvents.begin();  it != allEvents.end();  ++it)
 	{
 		Event* e = *it;
Index: kalarm/Makefile.am
===================================================================
--- kalarm/Makefile.am	(.../tags/KDE/3.5.10/kdepim)	(revision 987532)
+++ kalarm/Makefile.am	(.../branches/KDE/3.5/kdepim)	(revision 987532)
@@ -33,7 +33,7 @@
 	$(top_builddir)/kalarm/kalarmd/libkalarmd.la \
 	$(top_builddir)/libkdepim/libkdepim.la \
 	$(top_builddir)/libkpimidentities/libkpimidentities.la \
-	-lkabc -lkutils $(LIB_KDEUI) $(ARTSLIB)
+	-lkabc -lkutils $(LIB_KDEUI) $(ARTSLIB) $(LIBXTST)
 noinst_HEADERS = alarmcalendar.h alarmevent.h alarmlistview.h alarmtext.h \
 	alarmtimewidget.h birthdaydlg.h daemon.h dcophandler.h deferdlg.h \
 	editdlg.h editdlgprivate.h emailidcombo.h eventlistviewbase.h find.h \
Index: kaddressbook/xxport/vcard_xxport.desktop
===================================================================
--- kaddressbook/xxport/vcard_xxport.desktop	(.../tags/KDE/3.5.10/kdepim)	(revision 987532)
+++ kaddressbook/xxport/vcard_xxport.desktop	(.../branches/KDE/3.5/kdepim)	(revision 987532)
@@ -37,7 +37,7 @@
 Name[nn]=KAB vCard XXPort programtillegg
 Name[pl]=Wtyczka KAB do importu/eksportu z/do formatu vCard
 Name[pt]='Plugin' XXPort para vCard do KAB
-Name[pt_BR]=Plugin de Im/Exportação de vCard do KAB
+Name[pt_BR]=Plug-in de Im/Exportação de vCard do KAB
 Name[ru]=Работа с vCard
 Name[sk]=KAB modul pre xxport z vCard
 Name[sl]=Vstavek KAB vCard XXPort
Index: kaddressbook/features/distributionlistng.desktop
===================================================================
--- kaddressbook/features/distributionlistng.desktop	(.../tags/KDE/3.5.10/kdepim)	(revision 987532)
+++ kaddressbook/features/distributionlistng.desktop	(.../branches/KDE/3.5/kdepim)	(revision 987532)
@@ -6,6 +6,7 @@
 Name[da]=Næste generations-plugin til KAB-Distribution-liste
 Name[de]=Verteilerlisten-Modul für neues Adressbuch
 Name[el]=Πρόσθετο επόμενης γενιάς λίστας διανομής του KAB
+Name[es]=Complemento de nueva generación KAB para listas de distribución
 Name[et]=KAB postiloendi järgmise põlvkonna plugin
 Name[fr]=Module de liste de diffusion nouvelle génération pour KAB
 Name[is]=Næstu kynslóðar íforrit fyrir KAB dreifilista
Index: Makefile.am.in
===================================================================
--- Makefile.am.in	(.../tags/KDE/3.5.10/kdepim)	(revision 987532)
+++ Makefile.am.in	(.../branches/KDE/3.5/kdepim)	(revision 987532)
@@ -38,6 +38,7 @@
 COMPILE_BEFORE_akregator = libkdepim
 COMPILE_BEFORE_knotes = libkdepim
 COMPILE_BEFORE_konsolekalendar = libkdepim
+COMPILE_BEFORE_kabc = libkdepim
 
 AUTOMAKE_OPTIONS = foreign 1.6.1
 DISTCLEANFILES = inst-apps
Index: libkholidays/holidays/holiday_ja
===================================================================
--- libkholidays/holidays/holiday_ja	(.../tags/KDE/3.5.10/kdepim)	(revision 987532)
+++ libkholidays/holidays/holiday_ja	(.../branches/KDE/3.5/kdepim)	(revision 987532)
@@ -1,80 +0,0 @@
-:
-: Japanese holiday file. Copy to ~/.holiday
-: Author: Toyohiro Asukai <toyohiro@ksmplus.com>
-: Last modified on Nov 16 2004
-:
-: National Holidays. (English Messages)
-:small "New Year's Day" weekend on 1/1
-:small "Coming of Age" weekend on second monday in january
-:small "National Foundation Day" weekend on 2/11
-:small "Vernal Equinox Day" weekend on 3/20/2005
-:small "Vernal Equinox Day" weekend on 3/21/2006
-:small "Vernal Equinox Day" weekend on 3/21/2007
-:small "Vernal Equinox Day" weekend on 3/20/2008
-:small "Vernal Equinox Day" weekend on 3/20/2009
-:small "Vernal Equinox Day" weekend on 3/21/2010
-:small "Greenery Day" weekend on 4/29
-:small "Constitution Day" weekend on 5/3
-:small "Holiday" weekend on 5/4
-:small "Children's Day" weekend on 5/5
-:small "Oceans' Day" weekend on third monday in july
-:small "Respect for Senior Citizens Day" weekend on third monday in september
-:small "Autumnal Equinox Day" weekend on 9/23
-:small "Sports Day" weekend on second monday in october
-:small "Culture Day" weekend on 11/3
-:small "Labor Thanksgiving Day" weekend on 11/23
-:small "The Emperor's Birthday" weekend on 12/23
-
-: National Holidays. (Japanese and English messages)
-small "元旦(New Year's Day)" weekend on 1/1
-small "成人の日(Coming of Age)" weekend on second monday in january
-small "建国記念日(National Foundation Day)" weekend on 2/11
-small "春分の日(Vernal Equinox Day)" weekend on 3/20/2005
-small "春分の日(Vernal Equinox Day)" weekend on 3/21/2006
-small "春分の日(Vernal Equinox Day)" weekend on 3/21/2007
-small "春分の日(Vernal Equinox Day)" weekend on 3/20/2008
-small "春分の日(Vernal Equinox Day)" weekend on 3/20/2009
-small "春分の日(Vernal Equinox Day)" weekend on 3/21/2010
-small "みどりの日(Greenery Day)" weekend on 4/29
-small "憲法記念日(Constitution Day)" weekend on 5/3
-small "休日(Holiday)" weekend on 5/4
-small "こどもの日(Children's Day)" weekend on 5/5
-small "海の日(Oceans' Day)" weekend on third monday in july
-small "敬老の日(Respect for Senior Citizens Day)" weekend on third monday in september
-small "秋分の日(Autumnal Equinox Day)" weekend on 9/23
-small "体育の日(Sports Day)" weekend on second monday in october
-small "文化の日(Culture Day)" weekend on 11/3
-small "勤労感謝の日(Labor Thanksgiving Day)" weekend on 11/23
-small "天皇誕生日(The Emperor's Birthday)" weekend on 12/23
-
-: If a "National Holiday" is on Sunday,the following day
-: shall be a substitute holiday.
-:small "Substitute holiday" weekend on 3/21/2005
-:small "Substitute holiday" weekend on 1/2/2006
-:small "Substitute holiday" weekend on 2/12/2007
-:small "Substitute holiday" weekend on 4/30/2007
-:small "Substitute holiday" weekend on 9/24/2007
-:small "Substitute holiday" weekend on 12/24/2007
-:small "Substitute holiday" weekend on 11/24/2008
-:small "Substitute holiday" weekend on 3/22/2010
-
-small "振替休日(Substitute holiday)" weekend on 3/21/2005
-small "振替休日(Substitute holiday)" weekend on 1/2/2006
-small "振替休日(Substitute holiday)" weekend on 2/12/2007
-small "振替休日(Substitute holiday)" weekend on 4/30/2007
-small "振替休日(Substitute holiday)" weekend on 9/24/2007
-small "振替休日(Substitute holiday)" weekend on 12/24/2007
-small "振替休日(Substitute holiday)" weekend on 11/24/2008
-small "振替休日(Substitute holiday)" weekend on 3/22/2010
-
-
-: Japanese Events , not National Holidays.
-:small "St. Valentine's Day" on february 14
-:small "Girls' Festival" on march 3
-:small "Buddha's Birthday" on april 8
-:small "May Day" on may 1
-:small "Boys' Festival" on may 5
-:small "Mother's Day" on second sunday in may
-:small "Father's Day" on third sunday in june
-:small "Festival of the Weaver Star" on july 7
-:small "Christmas" on december 25
Index: libkholidays/holidays/holiday_jp
===================================================================
--- libkholidays/holidays/holiday_jp	(.../tags/KDE/3.5.10/kdepim)	(revision 0)
+++ libkholidays/holidays/holiday_jp	(.../branches/KDE/3.5/kdepim)	(revision 987532)
@@ -0,0 +1,80 @@
+:
+: Japanese holiday file. Copy to ~/.holiday
+: Author: Toyohiro Asukai <toyohiro@ksmplus.com>
+: Last modified on Nov 16 2004
+:
+: National Holidays. (English Messages)
+:small "New Year's Day" weekend on 1/1
+:small "Coming of Age" weekend on second monday in january
+:small "National Foundation Day" weekend on 2/11
+:small "Vernal Equinox Day" weekend on 3/20/2005
+:small "Vernal Equinox Day" weekend on 3/21/2006
+:small "Vernal Equinox Day" weekend on 3/21/2007
+:small "Vernal Equinox Day" weekend on 3/20/2008
+:small "Vernal Equinox Day" weekend on 3/20/2009
+:small "Vernal Equinox Day" weekend on 3/21/2010
+:small "Greenery Day" weekend on 4/29
+:small "Constitution Day" weekend on 5/3
+:small "Holiday" weekend on 5/4
+:small "Children's Day" weekend on 5/5
+:small "Oceans' Day" weekend on third monday in july
+:small "Respect for Senior Citizens Day" weekend on third monday in september
+:small "Autumnal Equinox Day" weekend on 9/23
+:small "Sports Day" weekend on second monday in october
+:small "Culture Day" weekend on 11/3
+:small "Labor Thanksgiving Day" weekend on 11/23
+:small "The Emperor's Birthday" weekend on 12/23
+
+: National Holidays. (Japanese and English messages)
+small "元旦(New Year's Day)" weekend on 1/1
+small "成人の日(Coming of Age)" weekend on second monday in january
+small "建国記念日(National Foundation Day)" weekend on 2/11
+small "春分の日(Vernal Equinox Day)" weekend on 3/20/2005
+small "春分の日(Vernal Equinox Day)" weekend on 3/21/2006
+small "春分の日(Vernal Equinox Day)" weekend on 3/21/2007
+small "春分の日(Vernal Equinox Day)" weekend on 3/20/2008
+small "春分の日(Vernal Equinox Day)" weekend on 3/20/2009
+small "春分の日(Vernal Equinox Day)" weekend on 3/21/2010
+small "みどりの日(Greenery Day)" weekend on 4/29
+small "憲法記念日(Constitution Day)" weekend on 5/3
+small "休日(Holiday)" weekend on 5/4
+small "こどもの日(Children's Day)" weekend on 5/5
+small "海の日(Oceans' Day)" weekend on third monday in july
+small "敬老の日(Respect for Senior Citizens Day)" weekend on third monday in september
+small "秋分の日(Autumnal Equinox Day)" weekend on 9/23
+small "体育の日(Sports Day)" weekend on second monday in october
+small "文化の日(Culture Day)" weekend on 11/3
+small "勤労感謝の日(Labor Thanksgiving Day)" weekend on 11/23
+small "天皇誕生日(The Emperor's Birthday)" weekend on 12/23
+
+: If a "National Holiday" is on Sunday,the following day
+: shall be a substitute holiday.
+:small "Substitute holiday" weekend on 3/21/2005
+:small "Substitute holiday" weekend on 1/2/2006
+:small "Substitute holiday" weekend on 2/12/2007
+:small "Substitute holiday" weekend on 4/30/2007
+:small "Substitute holiday" weekend on 9/24/2007
+:small "Substitute holiday" weekend on 12/24/2007
+:small "Substitute holiday" weekend on 11/24/2008
+:small "Substitute holiday" weekend on 3/22/2010
+
+small "振替休日(Substitute holiday)" weekend on 3/21/2005
+small "振替休日(Substitute holiday)" weekend on 1/2/2006
+small "振替休日(Substitute holiday)" weekend on 2/12/2007
+small "振替休日(Substitute holiday)" weekend on 4/30/2007
+small "振替休日(Substitute holiday)" weekend on 9/24/2007
+small "振替休日(Substitute holiday)" weekend on 12/24/2007
+small "振替休日(Substitute holiday)" weekend on 11/24/2008
+small "振替休日(Substitute holiday)" weekend on 3/22/2010
+
+
+: Japanese Events , not National Holidays.
+:small "St. Valentine's Day" on february 14
+:small "Girls' Festival" on march 3
+:small "Buddha's Birthday" on april 8
+:small "May Day" on may 1
+:small "Boys' Festival" on may 5
+:small "Mother's Day" on second sunday in may
+:small "Father's Day" on third sunday in june
+:small "Festival of the Weaver Star" on july 7
+:small "Christmas" on december 25

Property changes on: libkholidays/holidays/holiday_jp
___________________________________________________________________
Added: svn:keywords
   + Author Date Id Revision
Added: svn:mergeinfo

Index: libkholidays/holidays/holiday_pl
===================================================================
--- libkholidays/holidays/holiday_pl	(.../tags/KDE/3.5.10/kdepim)	(revision 987532)
+++ libkholidays/holidays/holiday_pl	(.../branches/KDE/3.5/kdepim)	(revision 987532)
@@ -2,36 +2,37 @@
 : sob kwi 10 15:47:14 CEST 1999
 : by Krzysztof P. Jasiutowicz <kpjas@promail.pl>
 :
-
-small      "Nowy Rok"              on 1.1.
-small      "Trzech Króli"          weekend on 6.1.
-: small      "Śledzik"             on easter minus 47 days
+small      "Nowy Rok"              weekend on 1.1.
+small      "Trzech Króli"          on 6.1.
+small      "Dzień Babci"           on 21.1.
+small      "Dzień Dziadka"         on 22.1.
+: small      "Śledzik"               on easter minus 47 days
 small      "Popielec"              on easter minus 46 days
+small      "Wielki Piątek"         on easter minus  2 days
 small      "Dzień Kobiet"          on 8.3.
-small      "Wielki Piątek"         weekend on easter minus  2 days
+small      "Niedziela Palmowa"     on easter minus 7 days
 small      "Wielkanoc"             weekend on easter length 2 days
 small      "Lany Poniedziałek"     weekend on easter plus 1 day
-small      "Niedziela Palmowa"     on easter minus 7 days
 small      "Zielone Świątki"       weekend on easter plus 49 days
-small      "Boże Ciało"            on easter plus 60 days
-small      "Wniebowzięcie NMP"     on 15.8
-small      "Święto Pracy"          on 1.5.
-small      "Święto Konstytucji"    on 3.5.
-small      "Wszystkich Świętych"   on 1.11.
+small      "Boże Ciało"            weekend on easter plus 60 days
+small      "Święto Pracy"          weekend on 1.5.
+small      "Dzień Flagi"           on 2.5.
+small      "Święto Konstytucji"    weekend on 3.5.
+small      "Wniebowzięcie NMP"     weekend on 15.8.
+small      "Wszystkich Świętych"   weekend on 1.11.
 small      "Zaduszki"              on 2.11.
-small      "Święto Niepodległości" on 11.11.
+small      "Święto Niepodległości" weekend on 11.11.
 small      "Wigilia"               on 24.12.
-small      "Boże Narodzenie"       on 25.12. length 2 days
+small      "Boże Narodzenie"       weekend on 25.12. length 2 days
 small      "Sylwester"             on 31.12.
 
-small      "Dzień Babci"           weekend on 21.1.
-small      "Dzień Dziadka"         weekend on 22.1.
-small black  "Andrzejki"           on 30.11.
+
+small black  "Walentynki"          on 14.2.
 small black  "Dzień Matki"         on 26.5.
+small black  "Dzień Dziecka"       on 1.6.
 small black  "Dzień Ojca"          on 23.6.
-small black  "Dzień Dziecka"       on 1.6.
-small black  "Św. Mikołaj"         on  6.12.
-small black  "Walentynki"          on 14.2.
+small black  "Andrzejki"           on 30.11.
+small black  "Św. Mikołaj"         on 6.12.
 
 
 "Początek wiosny" on march 21
Index: libkholidays/holidays/holiday_ru
===================================================================
--- libkholidays/holidays/holiday_ru	(.../tags/KDE/3.5.10/kdepim)	(revision 987532)
+++ libkholidays/holidays/holiday_ru	(.../branches/KDE/3.5/kdepim)	(revision 987532)
@@ -106,6 +106,6 @@
 blue 	"День Конституции Российской Федерации" on 12.12
 blue 	"День Ракетных войск стратегического назначения" on 17.12
 blue 	"День работника органов безопасности Российской Федерации" on 20.12
-blue 	"День энергетика" on third sunday in december
+blue   "День энергетика" on 22.12
 blue 	"День взятия крепости Измаил (1790 год)" on 24.12
 blue 	"День спасателя Российской Федерации" on 27.12
Index: libkholidays/holidays/holiday_ar
===================================================================
--- libkholidays/holidays/holiday_ar	(.../tags/KDE/3.5.10/kdepim)	(revision 987532)
+++ libkholidays/holidays/holiday_ar	(.../branches/KDE/3.5/kdepim)	(revision 987532)
@@ -7,6 +7,7 @@
 : Related national laws
 : http://www.uncu.edu.ar/contenido/skins/unc/download/Ley%2023555.pdf
 : http://www.uncu.edu.ar/contenido/skins/unc/download/Ley%2024445.pdf
+: http://www.puntoprofesional.com/P/0650/LEY_26416.HTM
 :
 : Author: Daniel Vega <dv5a@dc.uba.ar>
 
@@ -22,9 +23,8 @@
 small "Día de Manuel Belgrano" weekend on third monday in june
 small "Día de la Independencia" weekend on 7/9
 small "Día de San Martín" weekend on third monday in august
-small "Día de la Raza" weekend on (([10/12] == [friday  after ([10/11])] || [10/12] == [thursday  after ([10/11])]) ? [monday after  ([10/12])] : 
-                                  (([10/12] == [tuesday after ([10/11])] || [10/12] == [wednesday after ([10/11])]) ? [monday before ([10/12])] :
-                                    [10/12]))
+small "Día de la Raza" weekend on  (([10/12] == [tuesday after ([10/11])] || [10/12] == [wednesday after ([10/11])]) ? [monday before ([10/12])] :
+                                    [monday after  ([10/11])])
 small "Inmaculada Concepción de María" weekend on 12/8
 small "Navidad" weekend on 12/25
 
Index: libkholidays/holidays/holiday_se
===================================================================
--- libkholidays/holidays/holiday_se	(.../tags/KDE/3.5.10/kdepim)	(revision 987532)
+++ libkholidays/holidays/holiday_se	(.../branches/KDE/3.5/kdepim)	(revision 987532)
@@ -23,8 +23,8 @@
 :Before 2005
 :black "Nationaldagen" black on 6.6
 weekend "Nationaldagen" weekend on 6.6
-black "Midsommarafton" black on friday before 26.6
-weekend "Midsommardagen" weekend on saturday before 27.6
+black "Midsommarafton" black on friday before 25.6
+weekend "Midsommardagen" weekend on saturday before 26.6
 blue "Vintertid" on last sunday in october
 weekend "Alla helgons dag" weekend on first sunday in november minus 1
 black "1. Advent" on sunday before 24.12 minus 21 days
Index: libkholidays/holidays/Makefile.am
===================================================================
--- libkholidays/holidays/Makefile.am	(.../tags/KDE/3.5.10/kdepim)	(revision 987532)
+++ libkholidays/holidays/Makefile.am	(.../branches/KDE/3.5/kdepim)	(revision 987532)
@@ -8,7 +8,7 @@
                 holiday_ch holiday_cz holiday_de holiday_dk holiday_ee \
                 holiday_es holiday_fi holiday_fr holiday_frswiss holiday_gb \
                 holiday_gr holiday_gt \
-                holiday_hu holiday_is holiday_il holiday_it holiday_ja \
+                holiday_hu holiday_is holiday_il holiday_it holiday_jp \
                 holiday_lt holiday_mx \
                 holiday_nl \
                 holiday_no holiday_nz holiday_pl holiday_pt holiday_py \
Index: configure.in.in
===================================================================
--- configure.in.in	(.../tags/KDE/3.5.10/kdepim)	(revision 987532)
+++ configure.in.in	(.../branches/KDE/3.5/kdepim)	(revision 987532)
@@ -11,6 +11,12 @@
 if test "$x_includes" != "NONE"; then
   AC_DEFINE(HAVE_X11_HEADERS,1,Define if you have X11 header files)
 fi
+AC_CHECK_LIB(Xtst, XTestFakeKeyEvent, [LIBXTST=-lXtst],, -lX11)
+AC_SUBST(LIBXTST)
+if test "$LIBXTST" != ""; then
+  AC_CHECK_HEADER([X11/extensions/XTest.h],
+                  [AC_DEFINE(HAVE_XTEST, 1, [Define if you have X11 Xtest header files])])
+fi
 
 KDE_INIT_DOXYGEN([KDE PIM API Reference], [Version $VERSION])
 
Index: kabc/kabcdistlistupdater/kabcdistlistupdater.cpp
===================================================================
--- kabc/kabcdistlistupdater/kabcdistlistupdater.cpp	(.../tags/KDE/3.5.10/kdepim)	(revision 0)
+++ kabc/kabcdistlistupdater/kabcdistlistupdater.cpp	(.../branches/KDE/3.5/kdepim)	(revision 987532)
@@ -0,0 +1,95 @@
+/*
+    This file is part of libkabc.
+    Copyright (c) 2008 Tobias Koenig <tokoe@kde.org>
+
+    This library is free software; you can redistribute it and/or
+    modify it under the terms of the GNU Library General Public
+    License as published by the Free Software Foundation; either
+    version 2 of the License, or (at your option) any later version.
+
+    This library is distributed in the hope that it will be useful,
+    but WITHOUT ANY WARRANTY; without even the implied warranty of
+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+    Library General Public License for more details.
+
+    You should have received a copy of the GNU Library General Public License
+    along with this library; see the file COPYING.LIB.  If not, write to
+    the Free Software Foundation, Inc., 51 Franklin Street, Fifth Floor,
+    Boston, MA 02110-1301, USA.
+*/
+
+#include <kaboutdata.h>
+#include <kapplication.h>
+#include <kcmdlineargs.h>
+#include <ksimpleconfig.h>
+#include <kdebug.h>
+#include <kglobal.h>
+#include <klocale.h>
+#include <kstandarddirs.h>
+
+#include <kabc/stdaddressbook.h>
+#include <libkdepim/distributionlist.h>
+
+static const KCmdLineOptions options[] =
+{
+  { "disable-autostart", "Disable automatic startup on login", 0 },
+  KCmdLineLastOption
+};
+
+void convertDistributionLists()
+{
+  KSimpleConfig cfg( locateLocal( "data", "kabc/distlists" ) );
+  const QMap<QString, QString> entryMap = cfg.entryMap( "DistributionLists" );
+
+  if ( entryMap.isEmpty() ) // nothing to convert
+    return;
+
+  QMapConstIterator<QString, QString> it;
+  for ( it = entryMap.begin(); it != entryMap.end(); ++it ) {
+    const QString listName = it.key();
+    const QStringList entries = QStringList::split( ',', it.data(), true );
+
+    KPIM::DistributionList distList;
+    distList.setUid( KApplication::randomString( 10 ) );
+    distList.setName( listName );
+
+    if ( entries.count() > 1 ) {
+      for ( uint i = 0; i < entries.count(); i += 2 ) {
+        const QString uid = entries[ i ];
+        const QString preferredEMail = entries[ i + 1 ];
+
+        distList.insertEntry( uid, preferredEMail );
+      }
+    }
+
+    KABC::StdAddressBook::self()->insertAddressee( distList );
+  }
+
+  KABC::StdAddressBook::self()->save();
+}
+
+int main( int argc, char **argv )
+{
+  KApplication::disableAutoDcopRegistration();
+
+  KAboutData aboutData( "kabcdistlistupdater", "Converter tool for distribution lists", "0.1" );
+  aboutData.addAuthor( "Tobias Koenig", 0, "tokoe@kde.org" );
+
+  KCmdLineArgs::init( argc, argv, &aboutData );
+  KCmdLineArgs::addCmdLineOptions( options );
+
+  KApplication app( false, false );
+
+  KCmdLineArgs *args = KCmdLineArgs::parsedArgs();
+
+  if ( args->isSet( "disable-autostart" ) ) {
+    kdDebug() << "Disable autostart." << endl;
+
+    KConfig *config = app.config();
+    config->setGroup( "Startup" );
+    config->writeEntry( "EnableAutostart", false );
+  }
+
+  convertDistributionLists();
+}
+
Index: kabc/kabcdistlistupdater/Makefile.am
===================================================================
--- kabc/kabcdistlistupdater/Makefile.am	(.../tags/KDE/3.5.10/kdepim)	(revision 0)
+++ kabc/kabcdistlistupdater/Makefile.am	(.../branches/KDE/3.5/kdepim)	(revision 987532)
@@ -0,0 +1,12 @@
+INCLUDES = -I$(includedir)/kabc -I$(top_srcdir) $(all_includes)
+
+METASOURCES = AUTO
+
+bin_PROGRAMS = kabcdistlistupdater
+
+kabcdistlistupdater_LDFLAGS = $(all_libraries) $(KDE_RPATH)
+kabcdistlistupdater_LDADD = $(LIB_KABC) $(top_builddir)/libkdepim/libkdepim.la
+kabcdistlistupdater_SOURCES = kabcdistlistupdater.cpp
+
+autostart_DATA = kabcdistlistupdater.desktop
+autostartdir = $(datadir)/autostart
Index: kabc/kabcdistlistupdater/kabcdistlistupdater.desktop
===================================================================
--- kabc/kabcdistlistupdater/kabcdistlistupdater.desktop	(.../tags/KDE/3.5.10/kdepim)	(revision 0)
+++ kabc/kabcdistlistupdater/kabcdistlistupdater.desktop	(.../branches/KDE/3.5/kdepim)	(revision 987532)
@@ -0,0 +1,21 @@
+# KDE Config File
+[Desktop Entry]
+Name=kabcdistlistupdater
+Name[nl]=kabcdistlijstbijwerker
+Exec=kabcdistlistupdater --disable-autostart
+Icon=misc
+Type=Application
+Comment=Tool to update the old distribution lists to the new ones.
+Comment[ca]=Eina per actualitzar les llistes de distribució antigues a les noves.
+Comment[es]=Herramienta para actualizar las antiguas listas de distribución al nuevo formato.
+Comment[et]=Tööriist vanade postiloendite uuendamiseks uue vormi kohaselt.
+Comment[nds]=Warktüüch, dat ole Verdeellisten to niege opfrischt
+Comment[nl]=Hulpmiddel om de oude distributielijsten bij te werken tot de nieuwe.
+Comment[sk]=Nástroj na aktualizáciu starých ditribučných zoznamov na nové.
+Comment[sr]=Алат за ажурирање старих дистрибуционих листи новима.
+Comment[sr@Latn]=Алат за ажурирање старих дистрибуционих листи новима.
+Comment[sv]=Verktyg för att uppdatera gamla distributionslistor till nya.
+Terminal=false
+NoDisplay=true
+X-KDE-autostart-condition=kabcdistlistupdaterrc:Startup:EnableAutostart:true
+OnlyShowIn=KDE;
Index: kabc/Makefile.am
===================================================================
--- kabc/Makefile.am	(.../tags/KDE/3.5.10/kdepim)	(revision 987532)
+++ kabc/Makefile.am	(.../branches/KDE/3.5/kdepim)	(revision 987532)
@@ -1 +1,5 @@
-SUBDIRS = kabc2mutt
+if compile_newdistrlists
+KABCDISTLISTUPDATER=kabcdistlistupdater
+endif
+
+SUBDIRS = kabc2mutt $(KABCDISTLISTUPDATER)
Index: libkcal/incidence.cpp
===================================================================
--- libkcal/incidence.cpp	(.../tags/KDE/3.5.10/kdepim)	(revision 987532)
+++ libkcal/incidence.cpp	(.../branches/KDE/3.5/kdepim)	(revision 987532)
@@ -107,6 +107,8 @@
 
 Incidence& Incidence::operator=( const Incidence &i )
 {
+  if ( &i == this )
+    return *this;
   IncidenceBase::operator=( i );
   mRevision = i.mRevision;
   mCreated = i.mCreated;
Index: kontact/plugins/akregator/akregatorplugin.desktop
===================================================================
--- kontact/plugins/akregator/akregatorplugin.desktop	(.../tags/KDE/3.5.10/kdepim)	(revision 987532)
+++ kontact/plugins/akregator/akregatorplugin.desktop	(.../branches/KDE/3.5/kdepim)	(revision 987532)
@@ -19,6 +19,7 @@
 Comment[da]=Feed-læserkomponent (Akregator-plugin)
 Comment[de]=News-Leser (Akregator-Modul)
 Comment[el]=Συστατικό ανάγνωσης ροών (Πρόσθετο του Akregator)
+Comment[es]=Componente de lectura de fuentes (complemento de Akregator)
 Comment[et]=Uudistevoogude plugin (Akregator)
 Comment[fr]=Composant du lecteur de flux (Module pour Akregator)
 Comment[is]=Fréttastraumalestur (Akregator íforrit)
@@ -29,6 +30,7 @@
 Comment[nl]=Component om feeds te lezen (Akregator-plugin)
 Comment[pl]=Składnik do czytania kanałów RSS (wtyczka Akregator)
 Comment[ru]=Просмотр лент новостей (модуль Akregator)
+Comment[sk]=Komponent na čítanie kanálov (Modul pre Akregator)
 Comment[sr]=Компонента читања довода (прикључак Akregator-а)
 Comment[sr@Latn]=Komponenta čitanja dovoda (priključak Akregator-a)
 Comment[sv]=Komponent för läsning av kanaler (Akregator-insticksprogram)
@@ -71,7 +73,7 @@
 Name[pt]=Fontes
 Name[pt_BR]=Fontes de Notícias
 Name[ru]=Ленты новостей
-Name[sk]=Kŕmitka
+Name[sk]=Kanály
 Name[sl]=Viri
 Name[sr]=Доводи
 Name[sr@Latn]=Dovodi
Index: kontact/plugins/akregator/akregatorplugin3.2.desktop
===================================================================
--- kontact/plugins/akregator/akregatorplugin3.2.desktop	(.../tags/KDE/3.5.10/kdepim)	(revision 987532)
+++ kontact/plugins/akregator/akregatorplugin3.2.desktop	(.../branches/KDE/3.5/kdepim)	(revision 987532)
@@ -48,7 +48,7 @@
 Comment[nn]=Akregator-programtillegg
 Comment[pl]=Wtyczka Akregatora
 Comment[pt]='Plugin' Akregator
-Comment[pt_BR]=Plugin do Akregator
+Comment[pt_BR]=Plug-in do Akregator
 Comment[ru]=Модуль Akregator
 Comment[sk]=Modul Akregator
 Comment[sl]=Vstavek Akregator
@@ -98,7 +98,7 @@
 Name[pt]=Fontes
 Name[pt_BR]=Fontes de Notícias
 Name[ru]=Ленты новостей
-Name[sk]=Kŕmitka
+Name[sk]=Kanály
 Name[sl]=Viri
 Name[sr]=Доводи
 Name[sr@Latn]=Dovodi
Index: kontact/plugins/test/kptestplugin.desktop
===================================================================
--- kontact/plugins/test/kptestplugin.desktop	(.../tags/KDE/3.5.10/kdepim)	(revision 987532)
+++ kontact/plugins/test/kptestplugin.desktop	(.../branches/KDE/3.5/kdepim)	(revision 987532)
@@ -95,7 +95,7 @@
 Name[nn]=Test-programtillegg
 Name[nso]=Plugin ya Teko
 Name[pl]=Wtyczka testowa
-Name[pt_BR]=Plugin de Teste
+Name[pt_BR]=Plug-in de Teste
 Name[ro]=Modul de  test
 Name[ru]=Проверочный модуль
 Name[se]=Geahččalan-lassemoduvla
Index: kontact/plugins/weather/weatherplugin.desktop
===================================================================
--- kontact/plugins/weather/weatherplugin.desktop	(.../tags/KDE/3.5.10/kdepim)	(revision 987532)
+++ kontact/plugins/weather/weatherplugin.desktop	(.../branches/KDE/3.5/kdepim)	(revision 987532)
@@ -21,6 +21,7 @@
 Comment[da]=Vejrkomponent til Kontact
 Comment[de]=Wetter-Komponente für Kontact
 Comment[el]=Συστατικό καιρού του Kontact
+Comment[es]=Extensión de meteorología para Kontact
 Comment[et]=Kontacti ilmaplugin
 Comment[fr]=Composant météo pour Kontact
 Comment[is]=Kontact veðurfréttaeining
Index: kontact/plugins/knode/knodeplugin.desktop
===================================================================
--- kontact/plugins/knode/knodeplugin.desktop	(.../tags/KDE/3.5.10/kdepim)	(revision 987532)
+++ kontact/plugins/knode/knodeplugin.desktop	(.../branches/KDE/3.5/kdepim)	(revision 987532)
@@ -19,6 +19,7 @@
 Comment[da]=Nyhedskomponent (KNode-plugin)
 Comment[de]=News-Komponente (KNode-Modul)
 Comment[el]=Συστατικό ανάγνωσης νέων (Πρόσθετο του KNode)
+Comment[es]=Componente de noticias (complemento de KNode)
 Comment[et]=Uudistelugeja plugin (KNode)
 Comment[fr]=Composant de lecteur de nouvelles (Module pour KNode)
 Comment[is]=Fréttaeining (KNode íforrit)
Index: kontact/plugins/specialdates/kcmsdsummary.desktop
===================================================================
--- kontact/plugins/specialdates/kcmsdsummary.desktop	(.../tags/KDE/3.5.10/kdepim)	(revision 987532)
+++ kontact/plugins/specialdates/kcmsdsummary.desktop	(.../branches/KDE/3.5/kdepim)	(revision 987532)
@@ -16,6 +16,7 @@
 Name[da]=Oversigt over særlige datoer
 Name[de]=Übersicht über besondere Termine
 Name[el]=Επισκόπηση σημαντικών ημερομηνιών
+Name[es]=Resumen de fechas especiales
 Name[et]=Tähtpäevade ülevaade
 Name[fr]=Aperçu des dates importantes
 Name[is]=Yfirlit sérstakra daga
@@ -25,6 +26,7 @@
 Name[nds]=Översicht besünner Daten
 Name[nl]=Overzicht van speciale data
 Name[pl]=Daty specjalne
+Name[pt_BR]=Resumo de Datas Especiais
 Name[ru]=Сводка особых дат
 Name[sr]=Преглед посебних датума
 Name[sr@Latn]=Pregled posebnih datuma
Index: kontact/plugins/specialdates/specialdatesplugin.desktop
===================================================================
--- kontact/plugins/specialdates/specialdatesplugin.desktop	(.../tags/KDE/3.5.10/kdepim)	(revision 987532)
+++ kontact/plugins/specialdates/specialdatesplugin.desktop	(.../branches/KDE/3.5/kdepim)	(revision 987532)
@@ -72,6 +72,7 @@
 Comment[da]=Komponent til særlige datoer
 Comment[de]=Komponente für Übersicht über besondere Termine
 Comment[el]=Συστατικό σημαντικών ημερομηνιών
+Comment[es]=Componente de fechas especiales
 Comment[et]=Tähtpäevade plugin
 Comment[fr]=Composant des dates importantes
 Comment[is]=Eining fyrir sérstaka daga
@@ -81,6 +82,7 @@
 Comment[nds]=Komponent för besünner Daten
 Comment[nl]=Component voor overzicht van speciale data
 Comment[pl]=Składnik dat specjalnych
+Comment[pt_BR]=Componente de Datas Especiais
 Comment[ru]=Особые даты
 Comment[sr]=Компонента посебних датума
 Comment[sr@Latn]=Komponenta posebnih datuma
Index: kontact/plugins/kitchensync/kitchensync.desktop
===================================================================
--- kontact/plugins/kitchensync/kitchensync.desktop	(.../tags/KDE/3.5.10/kdepim)	(revision 987532)
+++ kontact/plugins/kitchensync/kitchensync.desktop	(.../branches/KDE/3.5/kdepim)	(revision 987532)
@@ -18,6 +18,8 @@
 Comment[da]=Synkronisergingskomponent (Kitchensync-plugin)
 Comment[de]=Abgleich-Komponente (KitchenSync-Modul)
 Comment[el]=Συστατικό συγχρονισμού (Πρόσθετο του Kitchensynk)
+Comment[en_GB]=Synchronisation Component (Kitchensynk Plugin)
+Comment[es]=Componente de sincronización (complemento de KitchenSync)
 Comment[et]=Sünkroniseerimise plugin (KitchenSync)
 Comment[fr]=Composant de synchronisation (Module KitchenSync)
 Comment[is]=Samstillingareining (KitchenSync íforrit)
@@ -28,6 +30,7 @@
 Comment[nl]=Synchronisatiecomponent (Kitchensynk-plugin)
 Comment[pl]=Składnik synchronizacji (wtyczka KitchenSync)
 Comment[ru]=Синхронизация (модуль KitchenSync)
+Comment[sk]=Synchronizačný komponent (Modul pre Kitchensynk)
 Comment[sr]=Компонента синхронизације (прикључак KitchenSync-а)
 Comment[sr@Latn]=Komponenta sinhronizacije (priključak KitchenSync-a)
 Comment[sv]=Synkroniseringskomponent (Kitchensynk-insticksprogram)
Index: kontact/plugins/kpilot/kpilotplugin.desktop
===================================================================
--- kontact/plugins/kpilot/kpilotplugin.desktop	(.../tags/KDE/3.5.10/kdepim)	(revision 987532)
+++ kontact/plugins/kpilot/kpilotplugin.desktop	(.../branches/KDE/3.5/kdepim)	(revision 987532)
@@ -21,6 +21,7 @@
 Comment[da]=Komponent til palm-værktøjer (KPilot-plugin)
 Comment[de]=Palm-Komponente (KPilot-Modul)
 Comment[el]=Συστατικό εργαλείων Palm (Πρόσθετο του KPilot)
+Comment[es]=Componente de herramientas de Palm (complemento KPilot)
 Comment[et]=Palmi tööriistade plugin (KPilot)
 Comment[fr]=Composant d'outils pour Palms (Module KPilot)
 Comment[is]=Palm verkfæraeining (KPilot íforrit)
Index: kontact/plugins/knotes/knotesplugin.desktop
===================================================================
--- kontact/plugins/knotes/knotesplugin.desktop	(.../tags/KDE/3.5.10/kdepim)	(revision 987532)
+++ kontact/plugins/knotes/knotesplugin.desktop	(.../branches/KDE/3.5/kdepim)	(revision 987532)
@@ -19,6 +19,7 @@
 Comment[da]=Notatkomponent (KNotes-plugin)
 Comment[de]=Notizen-Komponente (KNotes-Modul)
 Comment[el]=Συσταικό σημειώσεων (Πρόσθετο του KNotes)
+Comment[es]=Componente de notas (complemento de KNotes)
 Comment[et]=Märkmete plugin (KNotes)
 Comment[fr]=Composant de notes (Module KNotes)
 Comment[is]=Minnismiðaeining (KNotes íforrit)
Index: kontact/plugins/karm/karmplugin.desktop
===================================================================
--- kontact/plugins/karm/karmplugin.desktop	(.../tags/KDE/3.5.10/kdepim)	(revision 987532)
+++ kontact/plugins/karm/karmplugin.desktop	(.../branches/KDE/3.5/kdepim)	(revision 987532)
@@ -18,6 +18,7 @@
 Comment[da]=Time Tracker-komponent (KArm-plugin)
 Comment[de]=Zeitplaner-Komponente (KArm-Modul)
 Comment[el]=Συστατικό γραμμής χρόνου (Πρόσθετο του KArm)
+Comment[es]=Componente de seguimiento de tiempos (complemento de KArm)
 Comment[et]=Ajaarvestaja plugin (KArm)
 Comment[fr]=Composant de suivi temporel (Module pour KArm)
 Comment[is]=Tímastjórnunareining (KArm íforrit)
@@ -40,6 +41,7 @@
 Name[ca]=Cronòmetre
 Name[de]=Stoppuhr
 Name[el]=Χρονόμετρο
+Name[es]=Temporizador
 Name[et]=Ajaarvestaja
 Name[fr]=Minuteur
 Name[is]=Tímamælir
@@ -49,6 +51,7 @@
 Name[nl]=Tijdklok
 Name[pl]=Stoper
 Name[ru]=Таймер
+Name[sk]=Časovač
 Name[sr]=Тајмер
 Name[sr@Latn]=Tajmer
 Name[sv]=Tidmätning
Index: kontact/plugins/kaddressbook/kaddressbookplugin.desktop
===================================================================
--- kontact/plugins/kaddressbook/kaddressbookplugin.desktop	(.../tags/KDE/3.5.10/kdepim)	(revision 987532)
+++ kontact/plugins/kaddressbook/kaddressbookplugin.desktop	(.../branches/KDE/3.5/kdepim)	(revision 987532)
@@ -21,6 +21,7 @@
 Comment[da]=Kontaktkomponent (KAddressbook-plugin)
 Comment[de]=Kontakte-Komponente (Adressbuch-Modul)
 Comment[el]=Συστατικό επαφών (Πρόσθετο του KAdressbook)
+Comment[es]=Componente de contactos (complemento de KAddressbook)
 Comment[et]=Kontaktide plugin (KDE aadressiraamat)
 Comment[fr]=Composant des contacts (module externe KAdressBook)
 Comment[is]=Vistfangaskráreining (KAddressBook íforrit)
Index: kontact/plugins/korganizer/kcmkorgsummary.desktop
===================================================================
--- kontact/plugins/korganizer/kcmkorgsummary.desktop	(.../tags/KDE/3.5.10/kdepim)	(revision 987532)
+++ kontact/plugins/korganizer/kcmkorgsummary.desktop	(.../branches/KDE/3.5/kdepim)	(revision 987532)
@@ -16,6 +16,7 @@
 Name[da]=Oversigt over møder og gøremål
 Name[de]=Übersicht über Termine und Aufgaben
 Name[el]=Επισκόπηση ραντεβού και προς υλοποίηση εργασιών
+Name[es]=Resumen de citas y tareas pendientes
 Name[et]=Kohtumised ja ülesannete ülevaade
 Name[fr]=Aperçu des rendez-vous et des tâches
 Name[is]=Yfirlit um fundi og verkþætti
Index: kontact/plugins/korganizer/todoplugin.desktop
===================================================================
--- kontact/plugins/korganizer/todoplugin.desktop	(.../tags/KDE/3.5.10/kdepim)	(revision 987532)
+++ kontact/plugins/korganizer/todoplugin.desktop	(.../branches/KDE/3.5/kdepim)	(revision 987532)
@@ -21,6 +21,7 @@
 Comment[da]=Komponent til gøremålsliste (KOrganizer-plugin)
 Comment[de]=Aufgabenlisten-Komponente (KOrganizer-Modul)
 Comment[el]=Συστατικό λίστα προς υλοποίηση εργασιών (Πρόσθετο του KOrganizer)
+Comment[es]=Componente de tareas pendientes (complemento de KOrganizer)
 Comment[et]=Ülesannete nimekirja plugin (KOrganizer)
 Comment[fr]=Composant de la liste des tâches (Module KOrganizer)
 Comment[is]=Verkefnaeining (KOrganizer íforrit)
@@ -31,6 +32,7 @@
 Comment[nl]=Takenlijstcomponent (KOrganizer-plugin)
 Comment[pl]=Składnik zadań (wtyczka KOrganizer)
 Comment[ru]=Задачи (модуль KOrganizer)
+Comment[sk]=Komponent zoznamu úloh (Modul pre KOrganizer)
 Comment[sr]=Прикључак листе обавеза (прикључак KOrganizer-а)
 Comment[sr@Latn]=Priključak liste obaveza (priključak KOrganizer-a)
 Comment[sv]=Uppgiftslistkomponent (Korganizer-insticksprogram)
@@ -43,6 +45,7 @@
 Name[da]=Gøremål
 Name[de]=Aufgaben
 Name[el]=Προς υλοποίηση εργασίες
+Name[es]=Tareas pendientes
 Name[et]=Ülesanded
 Name[fr]=Tâches
 Name[is]=Verkefni
@@ -53,6 +56,7 @@
 Name[nl]=Takenlijst
 Name[pl]=Lista zadań
 Name[ru]=Задачи
+Name[sk]=Zoznam úloh
 Name[sr]=Обавезе
 Name[sr@Latn]=Obaveze
 Name[sv]=Uppgift
Index: kontact/plugins/korganizer/journalplugin.desktop
===================================================================
--- kontact/plugins/korganizer/journalplugin.desktop	(.../tags/KDE/3.5.10/kdepim)	(revision 987532)
+++ kontact/plugins/korganizer/journalplugin.desktop	(.../branches/KDE/3.5/kdepim)	(revision 987532)
@@ -21,6 +21,7 @@
 Comment[da]=Journalkomponent (KOrganizer-plugin)
 Comment[de]=Journal-Komponente (KOrganizer-Modul)
 Comment[el]=Συστατικό χρονικών (Πρόσθετο του KOrganizer)
+Comment[es]=Componente de diario (Complemento de KOrganizer)
 Comment[et]=Päevikuplugin (KOrganizer)
 Comment[fr]= Composant de journal (Module KOrganizer)
 Comment[is]=Dagbókareining (Journal KOrganizer íforrit)
Index: kontact/plugins/korganizer/korganizerplugin.desktop
===================================================================
--- kontact/plugins/korganizer/korganizerplugin.desktop	(.../tags/KDE/3.5.10/kdepim)	(revision 987532)
+++ kontact/plugins/korganizer/korganizerplugin.desktop	(.../branches/KDE/3.5/kdepim)	(revision 987532)
@@ -21,6 +21,7 @@
 Comment[da]=Kalenderkomponent (KOrganizer-plugin)
 Comment[de]=Kalender-Komponente (KOrganizer-Modul)
 Comment[el]=Συστατικό ημερολογίου (Πρόσθετο του KOrganizer)
+Comment[es]=Componente de calendario (complemento de KOrganizer)
 Comment[et]=Kalendriplugin (KOrganizer)
 Comment[fr]= Composant de calendrier (Module KOrganizer)
 Comment[is]=Dagatalseining (KOrganizer íforrit)
@@ -31,6 +32,7 @@
 Comment[nl]=Agendacomponent (KOrganizer-plugin)
 Comment[pl]=Składnik kalendarza (wtyczka KOrganizer)
 Comment[ru]=Календарь (модуль KOrganizer)
+Comment[sk]=Kalendárový komponent (Modeul pre KOrganizer)
 Comment[sr]=Компонента календара (прикључак KOrganizer-а)
 Comment[sr@Latn]=Komponenta kalendara (priključak KOrganizer-a)
 Comment[sv]=Kalenderkomponent (Korganizer-insticksprogram)
Index: kontact/plugins/kmail/kmailplugin.desktop
===================================================================
--- kontact/plugins/kmail/kmailplugin.desktop	(.../tags/KDE/3.5.10/kdepim)	(revision 987532)
+++ kontact/plugins/kmail/kmailplugin.desktop	(.../branches/KDE/3.5/kdepim)	(revision 987532)
@@ -22,6 +22,7 @@
 Comment[da]=Post-komponent (KMail-plugin)
 Comment[de]=E-Mail-Komponente (KMail-Modul)
 Comment[el]=Συστατικό αλληλογραφίας (Πρόσθετο του KMail)
+Comment[es]=Componente de correo electrónico (complemento de KMail)
 Comment[et]=E-posti plugin (KMail)
 Comment[fr]=Composant de courriel (Module pour KMail)
 Comment[is]=Pósteining (KMail íforrit)
@@ -31,7 +32,9 @@
 Comment[nds]=Nettpost-Komponent (KMail-Moduul)
 Comment[nl]=E-mailcomponent (KMail-plugin)
 Comment[pl]=Składnik poczty (wtyczka KMail)
+Comment[pt_BR]=Componente de e-mail (plug-in do KMail)
 Comment[ru]=Электронная почта (модуль KMail)
+Comment[sk]=Poštový komponent (Model pre KMail)
 Comment[sr]=Компонента е-поште (прикључак KMail-а)
 Comment[sr@Latn]=Komponenta e-pošte (priključak KMail-a)
 Comment[sv]=E-postkomponent (Kmail-insticksprogram)
@@ -43,6 +46,7 @@
 Name[ca]=Correu
 Name[da]=E-mail
 Name[el]=Αλληλογραφία
+Name[es]=Correo electrónico
 Name[et]=E-post
 Name[fr]=Courriel
 Name[is]=Tölvupóstur
@@ -52,7 +56,9 @@
 Name[nds]=Nettpost
 Name[nl]=E-mail
 Name[pl]=E-mail
+Name[pt_BR]=E-mail
 Name[ru]=Электронная почта
+Name[sk]=Pošta
 Name[sr]=Е-пошта
 Name[sr@Latn]=E-pošta
 Name[sv]=E-post
Index: kontact/plugins/kmail/kcmkmailsummary.desktop
===================================================================
--- kontact/plugins/kmail/kcmkmailsummary.desktop	(.../tags/KDE/3.5.10/kdepim)	(revision 987532)
+++ kontact/plugins/kmail/kcmkmailsummary.desktop	(.../branches/KDE/3.5/kdepim)	(revision 987532)
@@ -16,6 +16,7 @@
 Name[da]=Oversigt over e-mail
 Name[de]=E-Mail-Übersicht
 Name[el]=Επισκόπηση αλληλογραφίας
+Name[es]=Resumen de correo electrónico
 Name[et]=E-posti ülevaade
 Name[fr]=Aperçu du courriel
 Name[is]=Yfirsýn á tölvupóst
@@ -26,6 +27,7 @@
 Name[nl]=E-mailoverzicht
 Name[pl]=Poczta
 Name[ru]=Сведения о почте
+Name[sk]=Prehľad pošty
 Name[sr]=Преглед е-поште
 Name[sr@Latn]=Pregled e-pošte
 Name[sv]=E-postöversikt
@@ -38,6 +40,7 @@
 Comment[da]=Opsætning af post-opsummering
 Comment[de]=Einstellungen für E-Mail-Übersicht
 Comment[el]=Ρύθμιση σύνοψης αλληλογραφίας
+Comment[es]=Configuración del resumen de correo electrónico
 Comment[et]=E-posti kokkuvõtte seadistus
 Comment[fr]=Configuration du résumé des courriels
 Comment[is]=Uppsetning póstyfirlits
@@ -48,6 +51,7 @@
 Comment[nl]=Instellingen voor e-mailoverzicht
 Comment[pl]=Ustawienia podsumowania e-maili
 Comment[ru]=Настройка сводки почты
+Comment[sk]=Nastavenie súhrnu pošty
 Comment[sr]=Подешавање сажетка е-поште
 Comment[sr@Latn]=Podešavanje sažetka e-pošte
 Comment[sv]=Inställning av e-postöversikt
Index: kontact/plugins/summary/kcmkontactsummary.desktop
===================================================================
--- kontact/plugins/summary/kcmkontactsummary.desktop	(.../tags/KDE/3.5.10/kdepim)	(revision 987532)
+++ kontact/plugins/summary/kcmkontactsummary.desktop	(.../branches/KDE/3.5/kdepim)	(revision 987532)
@@ -16,6 +16,7 @@
 Name[da]=Elementer i opsummeringsvisning
 Name[de]=Elemente der Zusammenfassungsansicht
 Name[el]=Αντικείμενα προβολής σύνοψης
+Name[es]=Elementos de la vista de sumario
 Name[et]=Kokkuvõttevaate elemendid
 Name[it]=Elementi vista sommario
 Name[ja]=要約ビューの項目
Index: kontact/plugins/summary/summaryplugin.desktop
===================================================================
--- kontact/plugins/summary/summaryplugin.desktop	(.../tags/KDE/3.5.10/kdepim)	(revision 987532)
+++ kontact/plugins/summary/summaryplugin.desktop	(.../branches/KDE/3.5/kdepim)	(revision 987532)
@@ -17,6 +17,7 @@
 Comment[da]=Komponent for opsummeringsvisning
 Comment[de]=Zusammenfassungsansicht-Komponente
 Comment[el]=Συστατικό προβολής σύνοψης
+Comment[es]=Componente Vista de resumen
 Comment[et]=Kokkuvõttevaate plugin
 Comment[fr]=Composant de la vue résumée
 Comment[is]=Eining fyrir yfirlitssýn
Index: kontact/plugins/newsticker/newstickerplugin.desktop
===================================================================
--- kontact/plugins/newsticker/newstickerplugin.desktop	(.../tags/KDE/3.5.10/kdepim)	(revision 987532)
+++ kontact/plugins/newsticker/newstickerplugin.desktop	(.../branches/KDE/3.5/kdepim)	(revision 987532)
@@ -20,6 +20,7 @@
 Comment[da]=Nyhedstelegraf-komponent
 Comment[de]=Newsticker-Komponente
 Comment[el]=Συστατικό προβολέα ειδήσεων
+Comment[es]=Componente de teletipo de noticias
 Comment[et]=Uudistejälgija plugin
 Comment[fr]=Composant Newsticker
 Comment[is]=Fréttastrimilseining
Index: kontact/src/kontact.setdlg
===================================================================
--- kontact/src/kontact.setdlg	(.../tags/KDE/3.5.10/kdepim)	(revision 987532)
+++ kontact/src/kontact.setdlg	(.../branches/KDE/3.5/kdepim)	(revision 987532)
@@ -5,6 +5,7 @@
 Name[da]=Opsummeringsvisning
 Name[de]=Übersicht
 Name[el]=Προβολή σύνοψης
+Name[es]=Vista de resumen
 Name[et]=Kokkuvõttevaade
 Name[fr]=Vue résumée
 Name[is]=Yfirlitssýn
@@ -27,6 +28,7 @@
 Comment[da]=Konfiguration af Kontacts <b>Opsummeringsvisning</b>. Nogle plugins giver <i>Opsummeringsvisning</i>-elementer, vælg dem du ønsker på listen.
 Comment[de]=Einrichtung der <b>Zusammenfassungsansicht</b> von Kontact. Einige Kontact-Module stellen Elemente für die <i>Zusammenfassungsansicht</i> zur Verfügung. Wählen Sie hier, welche Elemente angezeigt werden sollen.
 Comment[el]=Ρύθμιση της <b>Προβολής σύνοψης</b> του  Kontact. Κάποια πρόσθετα παρέχουν αντικείμενα <i>Προβολή σύνοψης</i>· επιλέξτε αυτά που θέλετε να εμφανίζονται.
+Comment[es]=Configuración de Kontact <b>Vista de resumen</b>. Algunos complementos proveen elementos para la <i>Vista de resumen</i>, elija los que quiera listar.
 Comment[et]=Kontacti <b>kokkuvõttevaate</b> seadistamine. Mõned pluginad pakuvad <i>kokkuvõttevaate</i> elemente. Vali nimekirjas need, mida soovid näha.
 Comment[fr]=Configuration de Kontact <b> Vue résumée</b>. Certains modules fournissent des éléments de <i>Vue Résumée</i>, choisissez ceux que vous voulez voir listés.
 Comment[is]=Stillingar á <b>Yfirlitssýn</b>í Kontact. Sum íforrit koma með hluti í <i>Yfirlitssýn</i>, veldu þá sem þú vilt hafa á síðunni.
@@ -51,6 +53,7 @@
 Name[ca]=Correu
 Name[da]=E-mail
 Name[el]=Αλληλογραφία
+Name[es]=Correo electrónico
 Name[et]=E-post
 Name[fr]=Courriel
 Name[is]=Tölvupóstur
@@ -60,7 +63,9 @@
 Name[nds]=Nettpost
 Name[nl]=E-mail
 Name[pl]=E-mail
+Name[pt_BR]=E-mail
 Name[ru]=Электронная почта
+Name[sk]=Pošta
 Name[sr]=Е-пошта
 Name[sr@Latn]=E-pošta
 Name[sv]=E-post
@@ -73,6 +78,7 @@
 Comment[da]=Konfiguration af Kontacts e-mail-plugin <b>KMail</b>, inkluderer et <i>Opsummeringsvisnings-element</i> og repræsenterer en <i>Kontact-komponent</i>.
 Comment[de]=Einrichtung des E-Mail-Moduls <b>KMail</b> für Kontact. Die E-Mail-Komponente kann als <i>Kontact-Komponente<i> in die <i>Zusammenfassungsansicht</i> integriert werden.
 Comment[el]=Η ρύθμιση του προσθέτου αλληλογραφίας <b>KMail</b> του Kontact, περιέχει ένα <i>Αντικείμενο προβολής σύνοψης</i> και αντιπροσωπεύει ένα <i>Συστατικό του Kontact</i>.
+Comment[es]=Configuración del complemento de correo-e de Kontact <b>KMail</b>, incluye una <i>Vista de resumen</i> y representa un <i>Componente de Kontact</i>.
 Comment[et]=Kontacti e-posti plugina <b>KMaili</b> seadistamine, mis sisaldab <i>kokkuvõttevaate elementi</i>.
 Comment[fr]=Configuration du Module de Courriel de Kontact <b>KMail</b>, inclut un <i>Élément de Vue Résumée</i> et correspond à un <i>Composant de Kontact</i>.
 Comment[is]=Stillingar fyrir tölvupóstíforrit Kontact <b>KMail</b>, inniheldur <i>yfirlitssýnarhlut</i> sem stendur fyrir <i>Kontact einingu</i>.
@@ -157,6 +163,7 @@
 Comment[da]=Konfiguration af Kontacts adressebog-plugin <b>KAdressbook</b> som repræsenterer en <i>Kontact-komponent</i>.
 Comment[de]=Einrichtung des Adressbuch-Moduls für Kontact, welches eine <i>Kontact-Komponente</i> repräsentiert.
 Comment[el]=Ρύθμιση του πρόσθετου βιβλίου διευθύνσεων <b>KAdressbook</b> του Kontact που αντιπροσωπεύει ένα <i>Συστατικό του Kontact</i>.
+Comment[es]=Configuración del complemento de libreta de direcciones de Kontact <b> KAddressbok</b>, el cual representa un <i>Componente de Kontact</i>.
 Comment[et]=Kontacti aadressiraamatu plugina <b>KAdressbook</b> seaditamine.
 Comment[fr]=Configuration du Module de Carnet d'Adresses de Kontact <b> KAdressbook</b> qui correspond à un <i>Composant de Kontact</i>.
 Comment[is]=Stillingar fyrir vistfangaskráríforrit Kontact <b>KAdressbook</b>, inniheldur <i>yfirlitssýnarhlut</i> sem stendur fyrir <i>Kontact einingu</i>.
@@ -341,6 +348,7 @@
 Comment[da]=Konfiguration af Kontacts kalender-plugin <b>KOrganizer</b>, inkluderer et <i>Opsummeringsvisningselement</i> og repræsenterer en <i>Kontact-komponent</i>.
 Comment[de]=Einrichtung des Kalender-Moduls <b>KOrganizer</b> für Kontact, einschließlich der <i>Zusammenfassungsansicht</i>; repräsentiert eine <i>Kontact-Komponente</i>
 Comment[el]=Η ρύθμιση του προσθέτου ημερολογίου του <b>KOrganizer</b> του Kontact, περιέχει ένα <i>Αντικείμενο προβολής σύνοψης</i> και αντιπροσωπεύει ένα <i>Συστατικό του Kontact</i>.
+Comment[es]=Configuración del complemento de calendario de Kontact, <b> KOrganizer</b>, incluye una <i>Vista de resumen</i> y representa un <i>Componente de Kontact</i>.
 Comment[et]=Kontacti kalendriplugina <b>KOrganizeri</b> seadistamine, mis sisaldab <i>kokkuvõttevaate elementi</i>.
 Comment[fr]=Configuration du Module de Calendrier de Kontact <b>KOrganizer</b>, inclut un <i>Élément de Vue Résumée</i> et correspond à un <i>Composant de Kontact</i>.
 Comment[is]=Stillingar fyrir dagatalsíforrit Kontact <b>KOrganizer</b>, inniheldur <i>yfirlitssýnarhlut</i> sem stendur fyrir <i>Kontact einingu</i>.
@@ -425,6 +433,7 @@
 Comment[da]=Konfiguration af Kontacts nyheds-plugin <b>KNode</b> som repræsenterer en <i>Kontact-komponent</i>.
 Comment[de]=Einrichtung des News-Moduls <b>KNode</b> für Kontact; repräsentiert eine <i>Kontact-Komponente</i>
 Comment[el]=Ρύθμιση του πρόσθετου νέων <b>KNode</b> του Kontact που αντιπροσωπεύει ένα <i>Συστατικό του Kontact</i>.
+Comment[es]=Configuración del complemento de noticias de Kontact <b>KNode</b> , el cual representa un <i>Componente de Kontact</i>.
 Comment[et]=Kontacti uudisteplugina <b>KNode</b> seadistamine.
 Comment[fr]=Configuration du Module de Nouvelles de Kontact <b>KNode</b> qui correspond à un <i>Composant de Kontact</i>.
 Comment[is]=Stillingar fyrir fréttastraumsíforrit Kontact <b>KNode</b>, inniheldur <i>yfirlitssýnarhlut</i> sem stendur fyrir <i>Kontact einingu</i>.
@@ -509,6 +518,7 @@
 Comment[da]=Komponent til vejrinformation
 Comment[de]=Komponente für Wetterinformationen
 Comment[el]=Συστατικό πληροφοριών καιρού
+Comment[es]=Componente de información meteorológica
 Comment[et]=Ilmateate komponent
 Comment[fr]=Composant d'Informations météorologiques
 Comment[is]=Eining fyrir veðurupplýsingar
@@ -519,6 +529,7 @@
 Comment[nl]=Weerinformatiecomponent
 Comment[pl]=Składnik informacji o pogodzie
 Comment[ru]=Информация о погоде
+Comment[sk]=Informácie o počasí
 Comment[sr]=Компонента информација о времену
 Comment[sr@Latn]=Komponenta informacija o vremenu
 Comment[sv]=Komponent med väderrapport
Index: korganizer/korganizer_configplugins.desktop
===================================================================
--- korganizer/korganizer_configplugins.desktop	(.../tags/KDE/3.5.10/kdepim)	(revision 987532)
+++ korganizer/korganizer_configplugins.desktop	(.../branches/KDE/3.5/kdepim)	(revision 987532)
@@ -100,7 +100,7 @@
 Comment[nn]=Oppsett av KOrganizer-programtillegg
 Comment[pl]=Konfiguracja wtyczek KOrganizera
 Comment[pt]=Configuração de 'Plugins' do KOrganizer
-Comment[pt_BR]=Configuração dos Plugins do KOrganizer
+Comment[pt_BR]=Configuração dos Plug-ins do KOrganizer
 Comment[ru]=Настройки модуля KOrganizer
 Comment[sk]=Nastavenie modulu KOrganizer
 Comment[sl]=Nastavitve vstavka KOrganizerja
Index: korganizer/koincidencetooltip.h
===================================================================
--- korganizer/koincidencetooltip.h	(.../tags/KDE/3.5.10/kdepim)	(revision 987532)
+++ korganizer/koincidencetooltip.h	(.../branches/KDE/3.5/kdepim)	(revision 987532)
@@ -39,7 +39,7 @@
 class KOIncidenceToolTip : public QToolTip
 {
   public:
-    KOIncidenceToolTip(QWidget * widget, QToolTipGroup * group = 0 ):QToolTip (widget, group) {}
+    KOIncidenceToolTip(QWidget * widget, QToolTipGroup * group = 0 ):QToolTip (widget, group),mText(0) {}
 /*    ~KOIncidenceToolTip();*/
 
   public:
Index: korganizer/interfaces/calendar/calendarplugin.desktop
===================================================================
--- korganizer/interfaces/calendar/calendarplugin.desktop	(.../tags/KDE/3.5.10/kdepim)	(revision 987532)
+++ korganizer/interfaces/calendar/calendarplugin.desktop	(.../branches/KDE/3.5/kdepim)	(revision 987532)
@@ -47,7 +47,7 @@
 Comment[nso]=Plugin ya Tshupamabaka
 Comment[pl]=Wtyczka do kalendarza
 Comment[pt]='Plugin' de Calendário
-Comment[pt_BR]=Plugin de Calendário
+Comment[pt_BR]=Plug-in de Calendário
 Comment[ro]=Modul calendar
 Comment[ru]=Модуль календаря
 Comment[se]=Kaleandarlassemoduvla
Index: korganizer/interfaces/calendar/calendardecoration.desktop
===================================================================
--- korganizer/interfaces/calendar/calendardecoration.desktop	(.../tags/KDE/3.5.10/kdepim)	(revision 987532)
+++ korganizer/interfaces/calendar/calendardecoration.desktop	(.../branches/KDE/3.5/kdepim)	(revision 987532)
@@ -44,7 +44,7 @@
 Comment[nso]=Plugin ya Kgabiso ya Tshupamabaka
 Comment[pl]=Wtyczka do dekoracji kalendarza
 Comment[pt]='Plugin' de Decoração do Calendário
-Comment[pt_BR]=Plugin para Decoração do Calendário
+Comment[pt_BR]=Plug-in para Decoração do Calendário
 Comment[ro]=Modul decorare calendar
 Comment[ru]=Оформление календаря
 Comment[se]=Kaleandarčiŋaid lassemoduvla
Index: korganizer/plugins/datenums/datenums.desktop
===================================================================
--- korganizer/plugins/datenums/datenums.desktop	(.../tags/KDE/3.5.10/kdepim)	(revision 987532)
+++ korganizer/plugins/datenums/datenums.desktop	(.../branches/KDE/3.5/kdepim)	(revision 987532)
@@ -81,7 +81,7 @@
 Comment[nn]=For kvar dag vil dette programtillegget visa nummeret til denne dagen i året øvst i tidsplanen. 1. februar vil til dømes visast som dag 32.
 Comment[pl]=Ta wtyczka dla każdego dnia pokazuje jego numer kolejny w roku, na szczycie widoku planu. Na przykład, 1 luty to 32 dzień roku.
 Comment[pt]=Para cada dia, este 'plugin' mostra o seu número de dia do ano no topo da agenda. Por exemplo, o dia 1 de Fevereiro é o dia 32 do ano.
-Comment[pt_BR]=Para cada dia, esse plugin mostra o número do dia no topo da visão de agenda. Por exemplo, 1º de fevereiro é o dia 32 do ano.
+Comment[pt_BR]=Para cada dia, esse plug-in mostra o número do dia no topo da visão de agenda. Por exemplo, 1º de fevereiro é o dia 32 do ano.
 Comment[ru]=Этот модуль показывает номер дня в году для каждой даты. Например, для 1 февраля будет показан номер 32.
 Comment[sk]=Tento modul pre každý deň zobrazí jeho číslo dňa v roku navrchu pohľadu agendy. Napríklad 1. február je deň číslo 32 v roku.
 Comment[sl]=Za vsak dan ta vstavek prikazuje številko dneva v letu na vrhu praikaza agende. Npr., 1. februar je 32. dan v letu.
Index: korganizer/plugins/projectview/projectview.desktop
===================================================================
--- korganizer/plugins/projectview/projectview.desktop	(.../tags/KDE/3.5.10/kdepim)	(revision 987532)
+++ korganizer/plugins/projectview/projectview.desktop	(.../branches/KDE/3.5/kdepim)	(revision 987532)
@@ -42,7 +42,7 @@
 Name[nso]=Plugin ya Pono ya Porojeke ya KMmeakanyi
 Name[pl]=Wtyczka przeglądania projektów dla Organizatora
 Name[pt]='Plugin' de Gestão de Projectos para o KOrganizer
-Name[pt_BR]=Plugin de Visualização de Projetos para o KOrganizer
+Name[pt_BR]=Plug-in de Visualização de Projetos para o KOrganizer
 Name[ro]=Modul vizualizare proiect pentru KOrganizer
 Name[ru]=Просмотр проекта
 Name[sk]=KOrganizer modul pre projektový pohľad
@@ -92,7 +92,7 @@
 Comment[nn]=Dette programtillegget lagar ei prosjektplanvising for KOrganizer (slik som oppgåve- eller månadsvisingane). Dersom du brukar dette programtillegget, kan du visa oppgåvelista som i ein prosjektplanleggjar.
 Comment[pl]=Ta wtyczka tworzy widok planowania projektu w KOrganizerze (tak jak widok zadań do zrobienia lub widok miesiąca). Po włączeniu tej wtyczki możliwe jest przełączenie się na widok projektu zadań do zrobienia.
 Comment[pt]=Este 'plugin' oferece uma vista de planeamento de projectos para o KOrganizer (como as vistas de itens por-fazer ou mensais). Se activar este 'plugin', poderá mudar para a vista de projecto e ver a sua lista de itens por-fazer como num planeador de projectos.
-Comment[pt_BR]=Este plugin fornece uma visão de planejamento de projeto para o KOrganizer (como as visões de pendências ou de mês). Se você ativar este plugin, você pode mudar para a visão de projeto e ver a sua lista de pendências como num software de planejamento de projetos.
+Comment[pt_BR]=Este plug-in fornece uma visão de planejamento de projeto para o KOrganizer (como as visões de pendências ou de mês). Se você ativar este plugin, você pode mudar para a visão de projeto e ver a sua lista de pendências como num software de planejamento de projetos.
 Comment[ru]=Этот модуль показывает проект для органайзера KDE. Если вы подключите этот модуль, вы можете посмотреть ваши задачи в виде проекта.
 Comment[sk]=Tento modul poskytuje pohľad na plánovanie projektu pre KOrganizer (ako sú úlohy alebo mesačné pohľady). Ak povolíte tento modul, môžete prepínať projektový pohľad a pohľad na zoznam úloh ako plánovač projektu.
 Comment[sl]=Ta vstavek prikazuje projektno načrtovanje za KOrganizer (kot prikaz opravil ali mesečni prikaz). Če omogočite ta vstavek, lahko preklopite na projektni prikaz in si ogledate seznam opravil kot v projektnem prikazu.
Index: korganizer/plugins/exchange/exchange.desktop
===================================================================
--- korganizer/plugins/exchange/exchange.desktop	(.../tags/KDE/3.5.10/kdepim)	(revision 987532)
+++ korganizer/plugins/exchange/exchange.desktop	(.../branches/KDE/3.5/kdepim)	(revision 987532)
@@ -83,7 +83,7 @@
 Comment[nn]=Dette programtillegget lèt KOrganizer-brukarar arbeida saman med Microsoft Exchange 2000-gruppevaretenarar.
 Comment[pl]=Ta wtyczka pozwala KOrganizerowi współpracować z serwerami pracy grupowej Microsoft Exchange.
 Comment[pt]=Este 'plugin' permite aos utilizadores do KOrganizer lidarem com servidores de 'groupware' do Microsoft Exchange 2000.
-Comment[pt_BR]=Esse plugin permite que o KOrganizer conecte-se à servidores groupware Microsoft Exchance 2000
+Comment[pt_BR]=Esse plug-in permite que o KOrganizer conecte-se à servidores groupware Microsoft Exchance 2000
 Comment[ru]=Этот модуль позволяет пользователям органайзера работать с серверами совместной работы Microsoft Exchange 2000.
 Comment[sk]=Tento modul umožní, aby korganizer užívatelia pracovali s Microsoft Exchange 2000 groupware servermi.
 Comment[sl]=Ta vstavke omogoča uporabnikom KOrganizerja delo s strežniki Microsoft Exchange 2000.
Index: korganizer/plugins/printing/year/yearprint.desktop
===================================================================
--- korganizer/plugins/printing/year/yearprint.desktop	(.../tags/KDE/3.5.10/kdepim)	(revision 987532)
+++ korganizer/plugins/printing/year/yearprint.desktop	(.../branches/KDE/3.5/kdepim)	(revision 987532)
@@ -67,7 +67,7 @@
 Comment[nl]=Deze plugin maakt het mogelijk om een jaarkalender af te drukken.
 Comment[pl]=Ta wtyczka pozwala drukować roczny kalendarz.
 Comment[pt]=Este 'plugin' permite-lhe imprimir um calendário anual.
-Comment[pt_BR]=Este plugin permite imprimir um calendário anual.
+Comment[pt_BR]=Este plug-in permite imprimir um calendário anual.
 Comment[ru]=Этот модуль позволяет печатать календарь на год.
 Comment[sk]=Tento modul vám umožní vytlačiť kalendár na rok.
 Comment[sl]=Ta vstavek vam omogoča natis letnega koledarja.
Index: korganizer/plugins/printing/whatsnext/whatsnextprint.desktop
===================================================================
--- korganizer/plugins/printing/whatsnext/whatsnextprint.desktop	(.../tags/KDE/3.5.10/kdepim)	(revision 987532)
+++ korganizer/plugins/printing/whatsnext/whatsnextprint.desktop	(.../branches/KDE/3.5/kdepim)	(revision 987532)
@@ -77,7 +77,7 @@
 Comment[nn]=Dette programtillegget lèt deg skriva ut ei liste over alle dei komande hendingane og oppføringane i hugselista.
 Comment[pl]=Ta wtyczka pozwala wydrukować wszystkie przyszłe zdarzenia i zadania.
 Comment[pt]=Este 'plugin' permite-lhe imprimir uma lista com todos os eventos e itens por-fazer próximos.
-Comment[pt_BR]=Este plugin permite que você imprima uma lista de todos os eventos e pendências que estão por vir.
+Comment[pt_BR]=Este plug-in permite que você imprima uma lista de todos os eventos e pendências que estão por vir.
 Comment[ru]=Этот модуль позволяет печатать список будущих событий и задач.
 Comment[sk]=Tento modul umožní vytlačiť zoznam všetkých nadchádzajúcich udalostí a úloh.
 Comment[sl]=Ta vstavek vam omogoča natis seznama vseh prihahajočih dogodkov in čakajočih opravil.
Index: korganizer/plugins/printing/list/listprint.desktop
===================================================================
--- korganizer/plugins/printing/list/listprint.desktop	(.../tags/KDE/3.5.10/kdepim)	(revision 987532)
+++ korganizer/plugins/printing/list/listprint.desktop	(.../branches/KDE/3.5/kdepim)	(revision 987532)
@@ -77,7 +77,7 @@
 Comment[nn]=Dette programtillegget lèt deg skriva ut hendingar og hugselister på listeform.
 Comment[pl]=Ta wtyczka pozwala drukować zdarzenia i zadania w postaci listy.
 Comment[pt]=Este 'plugin' permite-lhe imprimir os eventos e os itens por-fazer no formato de uma lista.
-Comment[pt_BR]=Este plugin permite que você imprima eventos e pendências em forma de lista.
+Comment[pt_BR]=Este plug-in permite que você imprima eventos e pendências em forma de lista.
 Comment[ru]=Этот модуль позволяет печатать список событий и задач.
 Comment[sk]=Tento modul umožní vytlačiť udalosti a úlohy vo forme zoznamu.
 Comment[sl]=Ta vstavek vam omogoča natis dogodkov in čakajočih opravil v obliki seznama.
Index: korganizer/plugins/timespanview/timespanview.desktop
===================================================================
--- korganizer/plugins/timespanview/timespanview.desktop	(.../tags/KDE/3.5.10/kdepim)	(revision 987532)
+++ korganizer/plugins/timespanview/timespanview.desktop	(.../branches/KDE/3.5/kdepim)	(revision 987532)
@@ -33,7 +33,7 @@
 Name[nn]=Programtillegg for tidsromsvising i KOrganizer
 Name[pl]=Wtyczka widoku zakresu czasu dla KOrganizera
 Name[pt]='Plugin' de Vista de Intervalo de Tempo para o KOrganizer
-Name[pt_BR]=Plugin de Visualização de Período de Tempo Para o KOrganizer
+Name[pt_BR]=Plug-in de Visualização de Período de Tempo Para o KOrganizer
 Name[ru]=Диаграмма Ганта для KOrganizer
 Name[sk]=KOrganizer modul pre projektový pohľad
 Name[sl]=Vstavek za časovni prikaz za KOrganizer
@@ -76,7 +76,7 @@
 Comment[nl]=Deze plugin biedt een weergave voor KOrganizer (zoals de takenlijst en de maandweergave). Wanneer u deze plugin inschakelt kunt u kiezen voor een weergave waarin u uw evenementen in een Gantt-diagram kunt bekijken.
 Comment[pl]=Ta wtyczka tworzy widok zakresu czasu w KOrganizerze (tak jak widok zadań do zrobienia lub widok miesiąca). Po włączeniu tej wtyczki możliwe jest przełączenie się na widok zakresu czasu i przeglądanie zdarzeń jak na diagramie Gantta.
 Comment[pt]=Este 'plugin' oferece uma vista de distribuição temporal para o KOrganizer (como as vistas de itens por-fazer ou mensais). Se activar este 'plugin', poderá mudar para a vista de distribuição temporal e ver os seus eventos como num diagrama de Gantt.
-Comment[pt_BR]=Este plugin fornece uma visão de período de tempo para o KOrganizer (como a visão de pendências e do mês). Se você ativar este plugin, você pode mudar para a visão de período de tempo e ver seus eventos como num diagrama de Gantt.
+Comment[pt_BR]=Este plug-in fornece uma visão de período de tempo para o KOrganizer (como a visão de pendências e do mês). Se você ativar este plugin, você pode mudar para a visão de período de tempo e ver seus eventos como num diagrama de Gantt.
 Comment[ru]=Этот модуль показывает диаграмму Ганта для органайзера KDE. Если вы подключите этот модуль, вы можете посмотреть ваши события в виде диаграммы Ганта.
 Comment[sk]=Tento modul poskytuje projektový pohľad pre korganizer (ako sú úlohy alebo mesačné pohľady). Ak povolíte tento modul, môžete prepínať projektový pohľad a pohľad na udalosti ako je Gantt diagram.
 Comment[sl]=Ta vstavek ponuja časovni prikaz za KOrganizer (kot prikaz opravil ali mesečni prikaz). Če omogočite ta vstavek, lahko preklopite na časovni prikaz in si ogledate dogodke kot v Ganttovem diagramu.
Index: korganizer/korganizer_configviews.desktop
===================================================================
--- korganizer/korganizer_configviews.desktop	(.../tags/KDE/3.5.10/kdepim)	(revision 987532)
+++ korganizer/korganizer_configviews.desktop	(.../branches/KDE/3.5/kdepim)	(revision 987532)
@@ -37,7 +37,7 @@
 Name[he]=תצוגות
 Name[hi]=दृश्य
 Name[hu]=Nézetek
-Name[is]=Sýn
+Name[is]=Sýnir
 Name[it]=Viste
 Name[ja]=ビューア
 Name[ka]=ხედები
Index: korganizer/koincidencetooltip.cpp
===================================================================
--- korganizer/koincidencetooltip.cpp	(.../tags/KDE/3.5.10/kdepim)	(revision 987532)
+++ korganizer/koincidencetooltip.cpp	(.../branches/KDE/3.5/kdepim)	(revision 987532)
@@ -34,7 +34,7 @@
 */
 
 void KOIncidenceToolTip::add ( QWidget * widget, Incidence *incidence,
-        QToolTipGroup * group, const QString & longText )
+                               QToolTipGroup * group, const QString & longText )
 {
   if ( !widget || !incidence ) return;
   QToolTip::add(widget, IncidenceFormatter::toolTipString( incidence ), group, longText);
@@ -54,7 +54,7 @@
   KOAgendaItem *item = dynamic_cast<KOAgendaItem*>( parentWidget() );
   if ( !item )
     return;
-  if ( mText.isEmpty() )
+  if ( !mText )
     mText = IncidenceFormatter::toolTipString( item->incidence() );
   tip( QRect( QPoint( 0, 0 ), item->size() ), mText );
 }

Property changes on: .
___________________________________________________________________
Modified: svnmerge-blocked
   - /branches/kdepim/enterprise/kdepim:703472,703877,703925,704210,704221,704225-704226,704228-704229,704237,704988,704991-704992,704995,705006-705008,705190,705626,705751,705754-705758,705836,705995,706309,706493,706548-706549,706556,706560,706564,706572,706775,706802,767041,767555,767557,767947,769319,769355,771106,771252,772312,772317,775195,775203,775205-775206,775212,778002,778005-778006,778008-778009,778012,778030,778728,779449,779483,779506,779853,780453,780496,780498,780530,783128,783246-783247,784427,785479,785563,785570,788243-788244,791441-791442,793472,793539,795764,795766,798446,798449,798496,802149,802152,803260,803300,803309,803382,803398,805825,805827,810303,810305,814373,814375,816025,821379,821649,825076,825084,827945,827950,830876,830933,836276-836277,836429,837232,837782,837785,840707,840711,846420,846427
   + /branches/kdepim/enterprise/kdepim:703472,703877,703925,704210,704221,704225-704226,704228-704229,704237,704988,704991-704992,704995,705006-705008,705190,705626,705751,705754-705758,705836,705995,706309,706493,706548-706549,706556,706560,706564,706572,706775,706802,767041,767555,767557,767947,769319,769355,771106,771252,772312,772317,775195,775203,775205-775206,775212,778002,778005-778006,778008-778009,778012,778030,778728,779449,779483,779506,779853,780453,780496,780498,780530,783128,783246-783247,784427,785479,785563,785570,788243-788244,791441-791442,793472,793539,795764,795766,798446,798449,798496,802149,802152,803260,803300,803309,803382,803398,805825,805827,810303,810305,814373,814375,816025,821379,821649,825076,825084,827945,827950,830876,830933,836276-836277,836429,837232,837782,837785,840707,840711,846420,846427,850907,850914,851185-851186,854246-854247
Modified: svnmerge-integrated
   - /branches/kdepim/enterprise/kdepim:1-767022,767033,767233-767554,767556,767558-767946,767948-769318,769320-769354,769356-771105,771107-771251,771253-772311,772313-772316,772318-775194,775196-775202,775204,775207-775211,775213-778001,778003-778004,778007,778010-778011,778013-778029,778031-778727,778729-779448,779450-779482,779484-779505,779507-779852,779854-779994,780211,780250-780452,780454-780495,780497,780499-780529,780531-782028,782030-783127,783129-783243,783245,783248-783477,783479-784380,784382-784426,784428-784691,784693-785478,785480-785558,787827,788582-791440,791443-792201,792203-793304,793306-793471,793473-793538,793540-795763,795765,795767-798445,798447-798448,798450-798495,798497-802148,802150-802151,802153-803259,803261-803299,803301-803308,803310-803380,803383-803397,803399-804993,804995-805347,805349-805427,805429-805459,805461-805824,805826,805828-809708,809710-810236,810238-810302,810304,810306-811205,811207-813547,813549-814372,814374,814376-816024,816026-816313,816315-816322,816324-817070,817072-817087,817089-819076,819078-821035,821037-821124,821126-821378,821380-821648,821650-822268,822270-824277,824279-825075,825077-825083,825085-826354,826356-827612,827614-827891,827893-827944,827946-827949,827951-830477,830479-830875,830877-830932,830934-836103,836105-836275,836278-836391,836393-836428,836430-837231,837233-837624,837626,840224-840428,840430-840706,840708-840710,840712-843750,843760
   + /branches/kdepim/enterprise/kdepim:1-767022,767033,767233-767554,767556,767558-767946,767948-769318,769320-769354,769356-771105,771107-771251,771253-772311,772313-772316,772318-775194,775196-775202,775204,775207-775211,775213-778001,778003-778004,778007,778010-778011,778013-778029,778031-778727,778729-779448,779450-779482,779484-779505,779507-779852,779854-779994,780211,780250-780452,780454-780495,780497,780499-780529,780531-782028,782030-783127,783129-783243,783245,783248-783477,783479-784380,784382-784426,784428-784691,784693-785478,785480-785558,787827,788582-791440,791443-792201,792203-793304,793306-793471,793473-793538,793540-795763,795765,795767-798445,798447-798448,798450-798495,798497-802148,802150-802151,802153-803259,803261-803299,803301-803308,803310-803380,803383-803397,803399-804993,804995-805347,805349-805427,805429-805459,805461-805824,805826,805828-809708,809710-810236,810238-810302,810304,810306-811205,811207-813547,813549-814372,814374,814376-816024,816026-816313,816315-816322,816324-817070,817072-817087,817089-819076,819078-821035,821037-821124,821126-821378,821380-821648,821650-822268,822270-824277,824279-825075,825077-825083,825085-826354,826356-827612,827614-827891,827893-827944,827946-827949,827951-830477,830479-830875,830877-830932,830934-836103,836105-836275,836278-836391,836393-836428,836430-837231,837233-837624,837626,840224-840428,840430-840706,840708-840710,840712-843750,843760,858460,882936
Deleted: svn:mergeinfo
Added: svn:externals
   + admin https://svn.kde.org/home/kde/branches/KDE/3.5/kde-common/admin


